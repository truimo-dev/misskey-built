import{aF as D,M as E,J as p,E as F}from"./3iSoGi4ic-DV-GuiCp.js";import{u as V}from"./3iSoGi4ic-DCTAa4Sx.js";import{M as W}from"./3iSoGi4ic-CC5SbM-1.js";import{b as z,a as g,z as h,f as y,i,h as o,p as l,g as U,l as u,t as v,B as L,D as I,E as M,F as $,A as J}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const S={key:0,class:"init"},T={key:2,class:"users"},x="userList",Z=z({__name:"WidgetUserList",props:{widget:{}},emits:["updateProps"],setup(C,{expose:B,emit:b}){const N={showHeader:{type:"boolean",default:!0},listId:{type:"string",default:null,hidden:!0}},d=C,A=b,{widgetProps:t,configure:k,save:H}=V(x,N,d,A),n=g(null),w=g([]),c=g(!0);async function P(){const a=await p("users/lists/list"),{canceled:s,result:r}=await F({title:"Vybrat seznam",items:a.map(e=>({value:e.id,label:e.name})),default:t.listId});if(s||r==null)return;const m=a.find(e=>e.id===r);t.listId=m.id,H(),_()}const _=()=>{if(t.listId==null){c.value=!1;return}p("users/lists/show",{listId:t.listId}).then(a=>{n.value=a,p("users/show",{userIds:n.value.userIds??[]}).then(s=>{w.value=s,c.value=!1})})};return D(_,1e3*60,{immediate:!0,afterMounted:!0}),B({name:x,configure:k,id:d.widget?d.widget.id:null}),(a,s)=>{const r=h("MkLoading"),m=h("MkAvatar");return i(),y(W,{showHeader:v(t).showHeader,class:"mkw-userList"},{icon:o(()=>[...s[1]||(s[1]=[l("i",{class:"ti ti-users"},null,-1)])]),header:o(()=>[I(M(n.value?n.value.name:"Seznam uživatelů"),1)]),func:o(({buttonStyleClass:e})=>[l("button",{class:U(["_button",e]),onClick:s[0]||(s[0]=j=>v(k)())},[...s[2]||(s[2]=[l("i",{class:"ti ti-settings"},null,-1)])],2)]),default:o(()=>[l("div",{class:"xrNgm"},[v(t).listId==null?(i(),u("div",S,[L(E,{primary:"",onClick:P},{default:o(()=>[I(M("Vybrat seznam"),1)]),_:1})])):c.value?(i(),y(r,{key:1})):(i(),u("div",T,[(i(!0),u($,null,J(w.value,e=>(i(),u("span",{key:e.id,class:"user"},[L(m,{user:e,class:"avatar",indicator:"",link:"",preview:""},null,8,["user"])]))),128))]))],2)]),_:1},8,["showHeader"])}}});export{Z as default};
