import{a7 as R,ab as U,M,ad as I,L as V,C as A,J as D}from"./3iSoGi4ic-DV-GuiCp.js";import{M as S}from"./3iSoGi4ic-BDF7xMl0.js";import{_ as k}from"./3iSoGi4ic-Dz5OvLqt.js";import{b as B,u as N,a as m,f as C,i as w,a2 as $,h as a,D as i,E as s,p as t,B as d,C as P}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-CZYXc2mx.js";const H={class:"_spacer",style:{"--MI_SPACER-min":"20px","--MI_SPACER-max":"28px"}},Y={class:"_gaps_m"},_={value:"normal"},W={value:"banner"},z={value:"dialog"},h=B({__name:"MkUserAnnouncementEditDialog",props:{user:{},announcement:{}},emits:["done","closed"],setup(c,{emit:E}){const n=c,p=E,r=N("dialog"),f=m(n.announcement?n.announcement.title:""),v=m(n.announcement?n.announcement.text:""),y=m(n.announcement?n.announcement.icon:"info"),g=m(n.announcement?n.announcement.display:"dialog"),x=m(n.announcement?n.announcement.needConfirmationToRead:!1);async function T(){const u={title:f.value,text:v.value,icon:y.value,imageUrl:null,display:g.value,needConfirmationToRead:x.value,userId:n.user.id};if(n.announcement)await V("admin/announcements/update",{...u,id:n.announcement.id}),p("done",{updated:{...u,id:n.announcement.id}}),r.value?.close();else{const e=await V("admin/announcements/create",u);p("done",{created:e}),r.value?.close()}}async function b(){const{canceled:u}=await A({type:"warning",text:(({x})=>("Möchtest du „"+x+"“ wirklich entfernen?"))({x:f.value})});u||(n.announcement&&await D("admin/announcements/delete",{id:n.announcement.id}),p("done",{deleted:!0}),r.value?.close())}return(u,e)=>(w(),C(I,{ref_key:"dialog",ref:r,width:400,onClose:e[6]||(e[6]=l=>r.value?.close()),onClosed:e[7]||(e[7]=l=>p("closed"))},$({default:a(()=>[t("div",null,[t("div",H,[t("div",Y,[d(R,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l)},{label:a(()=>[i(s("Titel"),1)]),_:1},8,["modelValue"]),d(S,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=l=>v.value=l)},{label:a(()=>[i(s("Text"),1)]),_:1},8,["modelValue"]),d(k,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=l=>y.value=l)},{label:a(()=>[i(s("Symbol"),1)]),default:a(()=>[e[9]||(e[9]=t("option",{value:"info"},[t("i",{class:"ti ti-info-circle"})],-1)),e[10]||(e[10]=t("option",{value:"warning"},[t("i",{class:"ti ti-alert-triangle",style:{color:"var(--MI_THEME-warn)"}})],-1)),e[11]||(e[11]=t("option",{value:"error"},[t("i",{class:"ti ti-circle-x",style:{color:"var(--MI_THEME-error)"}})],-1)),e[12]||(e[12]=t("option",{value:"success"},[t("i",{class:"ti ti-check",style:{color:"var(--MI_THEME-success)"}})],-1))]),_:1},8,["modelValue"]),d(k,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=l=>g.value=l)},{label:a(()=>[i(s("Anzeigeart"),1)]),default:a(()=>[t("option",_,s("Normal"),1),t("option",W,s("Banner"),1),t("option",z,s("Dialogfeld"),1)]),_:1},8,["modelValue"]),d(U,{modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=l=>x.value=l)},{caption:a(()=>[i(s("Ist dies aktiviert, so wird beim Markieren dieser Ankündigung als gelesen ein separates Bestätigungsfenster angezeigt. Auch wird sie von der \"Alle als gelesen markieren\"-Funktion ausgenommen."),1)]),default:a(()=>[i(s("Separate Lesebestätigung erfordern")+" ",1)]),_:1},8,["modelValue"]),c.announcement?(w(),C(M,{key:0,danger:"",onClick:e[5]||(e[5]=l=>b())},{default:a(()=>[e[13]||(e[13]=t("i",{class:"ti ti-trash"},null,-1)),i(" "+s("Löschen"),1)]),_:1})):P("",!0)])]),t("div",{class:"xgYP5"},[d(M,{primary:"",rounded:"",style:{margin:"0 auto"},onClick:T},{default:a(()=>[e[14]||(e[14]=t("i",{class:"ti ti-check"},null,-1)),i(" "+s(n.announcement?"Aktualisieren":"Erstellen"),1)]),_:1})],2)])]),_:2},[c.announcement?{name:"header",fn:a(()=>[i(":"+s(c.announcement.title)+":",1)]),key:"0"}:{name:"header",fn:a(()=>[e[8]||(e[8]=i("New announcement",-1))]),key:"1"}]),1536))}});export{h as default};
