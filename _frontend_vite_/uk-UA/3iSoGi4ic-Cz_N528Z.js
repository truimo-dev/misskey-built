import{dd as $,de as H,M as _,L as T,h as W,bz as L,aS as N,P as z,az as F,ag as E}from"./3iSoGi4ic-DV-GuiCp.js";import{M as J}from"./3iSoGi4ic-CdSqfJMx.js";import{M as x}from"./3iSoGi4ic-Fx-BY70c.js";import{M as q}from"./3iSoGi4ic-BDF7xMl0.js";import{b as j,a as D,w as G,z as y,k as K,f as S,i as u,h as e,p as i,B as r,l as p,C as O,t as m,D as a,E as l,F as P,j as Q,m as X,c as A,R as B,A as Y}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-Dv7rS4og.js";const Z={key:0,class:"ti ti-check",style:{color:"var(--MI_THEME-success)"}},ee={key:1,class:"ti ti-x",style:{color:"var(--MI_THEME-error)"}},te={key:2,class:"ti ti-slash"},se={key:3,class:"ti ti-exclamation-circle",style:{color:"var(--MI_THEME-warn)"}},re={class:"_buttons"},oe={class:"_button _help"},le={class:"_gaps_s"},ae={style:{height:"300px","--MI-stickyTop":"0","--MI-stickyBottom":"0"}},ie={class:"_gaps_s"},ne={style:{height:"300px","--MI-stickyTop":"0","--MI-stickyBottom":"0"}},ue={class:"_gaps_s"},de={key:0},ce=j({__name:"MkAbuseReport",props:{report:{}},emits:["resolved"],setup(o,{emit:b}){const d=o,k=b,U=$(`/admin/user/${d.report.targetUserId}`);U.init();const v=$(`/admin/user/${d.report.reporterId}`);v.init();const f=D(d.report.moderationNote??"");G(f,async()=>{T("admin/update-abuse-user-report",{reportId:d.report.id,moderationNote:f.value}).then(()=>{})});function M(g){T("admin/resolve-abuse-user-report",{reportId:d.report.id,resolvedAs:g}).then(()=>{k("resolved",d.report.id)})}function I(){T("admin/forward-abuse-user-report",{reportId:d.report.id}).then(()=>{})}function R(g){W([{icon:"ti ti-hash",text:"Copy ID",action:()=>{L(d.report.id)}},{icon:"ti ti-json",text:"Copy JSON",action:()=>{L(JSON.stringify(d.report,null,"	"))}}],g.currentTarget??g.target)}return(g,t)=>{const n=y("MkAcct"),C=y("MkTime"),h=y("MkAvatar"),c=y("Mfm"),w=K("tooltip");return u(),S(x,null,{icon:e(()=>[o.report.resolved&&o.report.resolvedAs==="accept"?(u(),p("i",Z)):o.report.resolved&&o.report.resolvedAs==="reject"?(u(),p("i",ee)):o.report.resolved?(u(),p("i",te)):(u(),p("i",se))]),label:e(()=>[r(n,{user:o.report.targetUser},null,8,["user"]),t[4]||(t[4]=a(" (by ",-1)),r(n,{user:o.report.reporter},null,8,["user"]),t[5]||(t[5]=a(")",-1))]),caption:e(()=>[a(l(o.report.comment),1)]),suffix:e(()=>[r(C,{time:o.report.createdAt},null,8,["time"])]),footer:e(()=>[i("div",re,[o.report.resolved?O("",!0):(u(),p(P,{key:0},[r(_,{onClick:t[0]||(t[0]=V=>M("accept"))},{default:e(()=>[t[6]||(t[6]=i("i",{class:"ti ti-check",style:{color:"var(--MI_THEME-success)"}},null,-1)),a(" "+l("Resolve")+" ("+l("Accept")+")",1)]),_:1}),r(_,{onClick:t[1]||(t[1]=V=>M("reject"))},{default:e(()=>[t[7]||(t[7]=i("i",{class:"ti ti-x",style:{color:"var(--MI_THEME-error)"}},null,-1)),a(" "+l("Resolve")+" ("+l("Reject")+")",1)]),_:1}),r(_,{onClick:t[2]||(t[2]=V=>M(null))},{default:e(()=>[t[8]||(t[8]=i("i",{class:"ti ti-slash"},null,-1)),a(" "+l("Resolve")+" ("+l("Інше")+")",1)]),_:1})],64)),o.report.targetUser.host!=null?(u(),p(P,{key:1},[r(_,{disabled:o.report.forwarded,primary:"",onClick:I},{default:e(()=>[t[9]||(t[9]=i("i",{class:"ti ti-corner-up-right"},null,-1)),a(" "+l("Forward"),1)]),_:1},8,["disabled"]),Q((u(),p("div",oe,[...t[10]||(t[10]=[i("i",{class:"ti ti-help-circle"},null,-1)])])),[[w,"Forward the report to a remote server as an anonymous system account.","dialog"]])],64)):O("",!0),i("button",{class:"_button",style:{"margin-left":"auto",width:"34px"},onClick:R},[...t[11]||(t[11]=[i("i",{class:"ti ti-dots"},null,-1)])])])]),default:e(()=>[i("div",le,[r(x,{withSpacer:!1},{icon:e(()=>[r(h,{user:o.report.targetUser,style:{width:"18px",height:"18px"}},null,8,["user"])]),label:e(()=>[a(l("Target")+": ",1),r(n,{user:o.report.targetUser},null,8,["user"])]),suffix:e(()=>[a("#"+l(o.report.targetUserId.toUpperCase()),1)]),default:e(()=>[i("div",ae,[r(H,{router:m(U)},null,8,["router"])])]),_:1}),r(x,{defaultOpen:!0},{icon:e(()=>[...t[12]||(t[12]=[i("i",{class:"ti ti-message-2"},null,-1)])]),label:e(()=>[a(l("Детальніше"),1)]),default:e(()=>[i("div",ie,[r(c,{text:o.report.comment,linkNavigationBehavior:"window"},null,8,["text"])])]),_:1}),r(x,{withSpacer:!1},{icon:e(()=>[r(h,{user:o.report.reporter,style:{width:"18px",height:"18px"}},null,8,["user"])]),label:e(()=>[a(l("Репортер")+": ",1),r(n,{user:o.report.reporter},null,8,["user"])]),suffix:e(()=>[a("#"+l(o.report.reporterId.toUpperCase()),1)]),default:e(()=>[i("div",ne,[r(H,{router:m(v)},null,8,["router"])])]),_:1}),r(x,{defaultOpen:!1},{icon:e(()=>[...t[13]||(t[13]=[i("i",{class:"ti ti-message-2"},null,-1)])]),label:e(()=>[a(l("Moderation note"),1)]),suffix:e(()=>[a(l(f.value.length>0?"...":"Відсутній"),1)]),default:e(()=>[i("div",ue,[r(q,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=V=>f.value=V),manualSave:""},{caption:e(()=>[a(l("You can fill in notes that will be shared only among moderators."),1)]),_:1},8,["modelValue"])])]),_:1}),o.report.assignee?(u(),p("div",de,[a(l("Модератор")+": ",1),r(n,{user:o.report.assignee},null,8,["user"])])):O("",!0)])]),_:1})}}}),pe={class:"_spacer",style:{"--MI_SPACER-w":"900px"}},me={class:"_gaps"},we=j({__name:"abuses",setup(o){const{model:b,def:d}=N({items:[{label:"Всі",value:"all"},{label:"Не вирішено",value:"unresolved"},{label:"Вирішено",value:"resolved"}],initialValue:"unresolved"}),{model:k,def:U}=N({items:[{label:"Всі",value:"combined"},{label:"Локальні",value:"local"},{label:"Віддалені",value:"remote"}],initialValue:"combined"}),{model:v,def:f}=N({items:[{label:"Всі",value:"combined"},{label:"Локальні",value:"local"},{label:"Віддалені",value:"remote"}],initialValue:"combined"});D(""),D("");const M=X(new z("admin/abuse-user-reports",{limit:10,computedParams:A(()=>({state:b.value,reporterOrigin:k.value,targetUserOrigin:v.value}))}));function I(t){M.removeItem(t)}const R=A(()=>[]),g=A(()=>[]);return F(()=>({title:"Скарги",icon:"ti ti-exclamation-circle"})),(t,n)=>{const C=y("MkTip"),h=y("PageWithHeader");return u(),S(h,{actions:R.value,tabs:g.value},{default:e(()=>[i("div",pe,[i("div",{class:"xb6BP _gaps"},[i("div",{class:"xnLLW _gaps"},[r(_,{link:"",to:"/admin/abuse-report-notification-recipient",primary:""},{default:e(()=>[a(l("Параметри сповіщень"),1)]),_:1})],2),r(C,{k:"abuses"},{default:e(()=>[a(l("If the report's content is legitimate, select \"Accept\" to mark it as resolved.\nIf the report's content is illegitimate, select \"Reject\" to ignore it."),1)]),_:1}),i("div",{class:"x9NVu _gaps"},[r(E,{modelValue:m(b),"onUpdate:modelValue":n[0]||(n[0]=c=>B(b)?b.value=c:null),items:m(d),style:{margin:"0",flex:"1"}},{label:e(()=>[a(l("Стан"),1)]),_:1},8,["modelValue","items"]),r(E,{modelValue:m(v),"onUpdate:modelValue":n[1]||(n[1]=c=>B(v)?v.value=c:null),items:m(f),style:{margin:"0",flex:"1"}},{label:e(()=>[a(l("Про кого повідомлено"),1)]),_:1},8,["modelValue","items"]),r(E,{modelValue:m(k),"onUpdate:modelValue":n[2]||(n[2]=c=>B(k)?k.value=c:null),items:m(U),style:{margin:"0",flex:"1"}},{label:e(()=>[a(l("Хто повідомив"),1)]),_:1},8,["modelValue","items"])],2),r(J,{paginator:m(M)},{default:e(({items:c})=>[i("div",me,[(u(!0),p(P,null,Y(c,w=>(u(),S(ce,{key:w.id,report:w,onResolved:I},null,8,["report"]))),128))])]),_:1},8,["paginator"])],2)])]),_:1},8,["actions","tabs"])}}});export{we as default};
