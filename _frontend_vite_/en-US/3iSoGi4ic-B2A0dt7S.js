import{b as Z,a as M,e as $,z as u,f as c,i as a,h as v,l as p,C as f,s as U,t as s,p as o,B as i,E as r,T as N}from"./3iSoGi4ic-D0mTJ0Mu.js";import{ae as V,b as x,b9 as D,$ as w,aA as _,aW as b,dl as X,h as P,bX as W,J as H}from"./3iSoGi4ic-DV-GuiCp.js";import{i as Q,a as Y,M as j}from"./3iSoGi4ic-CsUWgtg6.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const J={key:1},G={key:1,style:{opacity:"0.7"}},K={key:2},re=Z({__name:"MkUserPopup",props:{showing:{type:Boolean},q:{},source:{}},emits:["closed","mouseover","mouseleave"],setup(A,{emit:E}){const n=A,y=E,I=V("middle"),e=M(null),h=M(0),T=M(0),g=M(!1);function q(l){if(e.value==null)return;const{menu:t,cleanup:m}=X(e.value);P(t,l.currentTarget??l.target).finally(m)}async function B(){if(typeof n.q=="object")e.value=n.q,g.value=!1;else{const l=n.q.startsWith("@")?W(n.q.substring(1)):{userId:n.q};H("users/show",l).then(t=>{n.showing&&(e.value=t,g.value=!1)},()=>{g.value=!0})}}return $(()=>{B();const l=n.source.getBoundingClientRect(),t=l.left+n.source.offsetWidth/2-300/2+window.scrollX,m=l.top+n.source.offsetHeight+window.scrollY;h.value=m,T.value=t}),(l,t)=>{const m=u("MkError"),F=u("MkAvatar"),d=u("MkA"),z=u("MkUserName"),L=u("MkAcct"),R=u("Mfm"),S=u("MkLoading");return a(),c(N,{enterActiveClass:s(x).s.animation?"xuLAZ":"",leaveActiveClass:s(x).s.animation?"xCh4n":"",enterFromClass:s(x).s.animation?"x3Unz":"",leaveToClass:s(x).s.animation?"xgsda":"",appear:"",onAfterLeave:t[4]||(t[4]=C=>y("closed"))},{default:v(()=>[A.showing?(a(),p("div",{key:0,class:"x1tDq _popup _shadow",style:U({zIndex:s(I),top:h.value+"px",left:T.value+"px"}),onMouseover:t[2]||(t[2]=()=>{y("mouseover")}),onMouseleave:t[3]||(t[3]=()=>{y("mouseleave")})},[g.value?(a(),c(m,{key:0,onRetry:t[0]||(t[0]=C=>B())})):e.value!=null?(a(),p("div",J,[o("div",{class:"xetf4",style:U(e.value.bannerUrl?{backgroundImage:`url(${s(x).s.disableShowingAnimatedImages?s(D)(e.value.bannerUrl):e.value.bannerUrl})`}:"")},[s(w)&&s(w).id!=e.value.id&&e.value.isFollowed?(a(),p("span",{key:0,class:"xtgap"},r("Follows you"),3)):f("",!0)],6),(a(),p("svg",{viewBox:"0 0 128 128",class:"xqfc1"},[...t[5]||(t[5]=[o("g",{transform:"matrix(1.6,0,0,1.6,-38.4,-51.2)"},[o("path",{d:"M64,32C81.661,32 96,46.339 96,64C95.891,72.184 104,72 104,72C104,72 74.096,80 64,80C52.755,80 24,72 24,72C24,72 31.854,72.018 32,64C32,46.339 46.339,32 64,32Z",style:{fill:"var(--MI_THEME-popup)"}})],-1)])],2)),i(d,{to:s(_)(e.value)},{default:v(()=>[i(F,{class:"xdcZv",user:e.value,indicator:""},null,8,["class","user"])]),_:1},8,["to"]),o("div",{class:"xmMls"},[i(d,{class:"xB0ER",to:s(_)(e.value)},{default:v(()=>[i(z,{user:e.value,nowrap:!1},null,8,["user"])]),_:1},8,["class","to"]),o("div",{class:"x8X77"},[i(L,{user:e.value},null,8,["user"])],2)],2),o("div",{class:"xtSaQ"},[e.value.description?(a(),c(R,{key:0,class:"xlaEm",text:e.value.description,author:e.value},null,8,["class","text","author"])):(a(),p("div",G,r("This user has not written their bio yet."),1))],2),o("div",{class:"x4wok"},[i(d,{class:"x33Tu",to:s(_)(e.value,"notes")},{default:v(()=>[o("div",{class:"xrhms"},r("Notes"),3),o("div",null,r(s(b)(e.value.notesCount)),1)]),_:1},8,["class","to"]),s(Q)(e.value)?(a(),c(d,{key:0,class:"x33Tu",to:s(_)(e.value,"following")},{default:v(()=>[o("div",{class:"xrhms"},r("Following"),3),o("div",null,r(s(b)(e.value.followingCount)),1)]),_:1},8,["class","to"])):f("",!0),s(Y)(e.value)?(a(),c(d,{key:1,class:"x33Tu",to:s(_)(e.value,"followers")},{default:v(()=>[o("div",{class:"xrhms"},r("Followers"),3),o("div",null,r(s(b)(e.value.followersCount)),1)]),_:1},8,["class","to"])):f("",!0)],2),o("button",{class:"_button xigRE",onClick:q},[...t[6]||(t[6]=[o("i",{class:"ti ti-dots"},null,-1)])],2),s(w)&&e.value.id!=s(w).id?(a(),c(j,{key:0,user:e.value,"onUpdate:user":t[1]||(t[1]=C=>e.value=C),class:"xbtsT",mini:""},null,8,["user","class"])):f("",!0)])):(a(),p("div",K,[i(S)]))],38)):f("",!0)]),_:1},8,["enterActiveClass","leaveActiveClass","enterFromClass","leaveToClass"])}}});export{re as default};
