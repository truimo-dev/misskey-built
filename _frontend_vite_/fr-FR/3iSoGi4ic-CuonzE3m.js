import{aS as j,y as K,ag as Q,M as V,J as X,af as Y,A as E,B as Z,C as q,z as J,W as G,b as m,az as H,ab as $,cB as ee,cA as te}from"./3iSoGi4ic-DV-GuiCp.js";import{M as O}from"./3iSoGi4ic-CSc4cSLM.js";import{b as L,a as g,ab as le,c as D,w as ae,z as h,l as b,i as x,B as a,C as ne,p as y,h as e,D as d,E as o,t as S,R as U,g as se,f as A,F as oe,A as ie,a0 as re}from"./3iSoGi4ic-D0mTJ0Mu.js";import{F as ue}from"./3iSoGi4ic-BBsRrkiB.js";import{M as de}from"./3iSoGi4ic-Fx-BY70c.js";import{M as T}from"./3iSoGi4ic-DughwgT7.js";import"./3iSoGi4ic-B1GPmOGN.js";import{M as ce}from"./3iSoGi4ic-4oa2bN0A.js";import"./3iSoGi4ic-D98_HDRS.js";const fe={class:"_gaps_m"},ve={class:"_buttons"},me=L({__name:"sounds.sound",props:{def:{}},emits:["update"],async setup(N,{emit:w}){let F,M;const c=N,I=w,{model:i,def:W}=j({items:K.map(r=>({label:s(r),value:r})),initialValue:c.def.type}),n=g("fileId"in c.def?c.def.fileId:void 0),l=g("fileUrl"in c.def?c.def.fileUrl:void 0),f=g(""),v=g(!1),_=g(!1),p=g(c.def.volume);i.value==="_driveFile_"&&n.value&&([F,M]=le(()=>X("drive/files/show",{fileId:n.value}).then(r=>{f.value=r.name}).catch(r=>{v.value=!0})),await F,M());function s(r){switch(r){case null:return "Rien";case"_driveFile_":return "Utiliser un effet sonore sur le Disque";default:return r}}const B=D(()=>f.value?f.value:l.value?l.value:"Veuillez sélectionner le fichier sur le Disque");function R(r){Y({anchorElement:r.currentTarget??r.target,multiple:!1,label:"Utiliser un effet sonore sur le Disque"}).then(async u=>{if(!u.type.startsWith("audio")){E({type:"warning",title:"Ce fichier n'est pas pris en charge",text:"Veuillez sélectionner un fichier audio"});return}if(await Z(u.url)>=2e3){const{canceled:k}=await q({type:"warning",title:"L'effet sonore est trop long",text:"Utiliser un effet sonore long peut affecter l'utilisation de Misskey. Voulez-vous encore continuer ?",okText:"Continuer",cancelText:"Annuler"});if(k)return}l.value=u.url,f.value=u.name,n.value=u.id,v.value=!1,_.value=!0})}ae([i,p],([r,u],[C,k])=>{C!==r&&r!=="_driveFile_"&&(l.value=void 0,f.value="",n.value=void 0,v.value=!1),_.value=!0});function P(){if(i.value==="_driveFile_"&&(!l.value||!n.value)){E({type:"warning",text:"Veuillez sélectionner le fichier sur le Disque"});return}J(i.value==="_driveFile_"?{type:"_driveFile_",fileId:n.value,fileUrl:l.value,volume:p.value}:{type:i.value,volume:p.value})}function z(){if(!(_.value===!1||v.value===!0)){if(i.value==="_driveFile_"&&!l.value){E({type:"warning",text:"Veuillez sélectionner le fichier sur le Disque"});return}i.value!=="_driveFile_"&&(l.value=void 0,f.value="",n.value=void 0),I("update",{type:i.value,fileId:n.value,fileUrl:l.value,volume:p.value}),G()}}return(r,u)=>{const C=h("MkCondensedLine");return x(),b("div",fe,[a(Q,{modelValue:S(i),"onUpdate:modelValue":u[0]||(u[0]=k=>U(i)?i.value=k:null),items:S(W)},{label:e(()=>[d(o("Sons"),1)]),_:1},8,["modelValue","items"]),S(i)==="_driveFile_"&&v.value===!0?(x(),b("div",{key:0,class:"xDBOW"},[a(V,{class:"xlArr",inline:"",rounded:"",primary:"",onClick:R},{default:e(()=>[d(o("Choisir le fichier"),1)]),_:1},8,["class"]),y("div",{class:"xiWjC"},[a(C,null,{default:e(()=>[d(o("It couldn't load the sound. Please change the setting."),1)]),_:1})],2)],2)):S(i)==="_driveFile_"?(x(),b("div",{key:1,class:"xDBOW"},[a(V,{class:"xlArr",inline:"",rounded:"",primary:"",onClick:R},{default:e(()=>[d(o("Choisir le fichier"),1)]),_:1},8,["class"]),y("div",{class:se(["_nowrap",!l.value&&"x2Pqw"])},o(B.value),3)],2)):ne("",!0),a(O,{modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=k=>p.value=k),min:0,max:1,step:.05,textConverter:k=>`${Math.floor(k*100)}%`},{label:e(()=>[d(o("Volume"),1)]),_:1},8,["modelValue","textConverter"]),y("div",ve,[a(V,{inline:"",onClick:P},{default:e(()=>[u[2]||(u[2]=y("i",{class:"ti ti-player-play"},null,-1)),d(" "+o("Écouter"),1)]),_:1}),a(V,{inline:"",primary:"",disabled:!_.value||v.value,onClick:z},{default:e(()=>[u[3]||(u[3]=y("i",{class:"ti ti-check"},null,-1)),d(" "+o("Enregistrer"),1)]),_:1},8,["disabled"])])])}}});const _e={class:"_gaps_m"},pe={class:"_gaps_s"},be=L({__name:"sounds",setup(N){const w=m.model("sound.notUseSound"),F=m.model("sound.useSoundOnlyWhenActive"),M=m.model("sound.masterVolume"),c=g({note:m.r["sound.on.note"],noteMy:m.r["sound.on.noteMy"],notification:m.r["sound.on.notification"],reaction:m.r["sound.on.reaction"],chatMessage:m.r["sound.on.chatMessage"]});function I(n){switch(n){case null:return "Rien";case"_driveFile_":return "Utiliser un effet sonore sur le Disque";default:return n}}async function i(n,l){const f={type:l.type,fileId:l.fileId,fileUrl:l.fileUrl,volume:l.volume};m.commit(`sound.on.${n}`,f),c.value[n]=f}function W(){for(const n of Object.keys(c.value)){const l=te(`sound.on.${n}`);m.commit(`sound.on.${n}`,l),c.value[n]=l}}return D(()=>[]),D(()=>[]),H(()=>({title:"Sons",icon:"ti ti-music"})),(n,l)=>{const f=h("SearchText"),v=h("SearchLabel"),_=h("SearchMarker"),p=h("MkLoading");return x(),A(_,{path:"/settings/sounds",label:"Sons",keywords:["sounds"],icon:"ti ti-music",markerId:"6fFIRXUww","data-in-app-search-marker-id":"6fFIRXUww",children:["EcwZE7dCl","9MxYVIf7k","94afQxKat"]},{default:e(()=>[y("div",_e,[a(ce,{icon:"/client-assets/speaker_high_volume_3d.png",color:"#ff006f"},{default:e(()=>[a(f,null,{default:e(()=>[d(o("You can configure the sound settings for playback in the client."),1)]),_:1})]),_:1}),a(_,{keywords:["mute"],markerId:"EcwZE7dCl","data-in-app-search-marker-id":"EcwZE7dCl"},{default:e(()=>[a(T,{k:"sound.notUseSound"},{default:e(()=>[a($,{modelValue:S(w),"onUpdate:modelValue":l[0]||(l[0]=s=>U(w)?w.value=s:null)},{label:e(()=>[a(v,null,{default:e(()=>[d(o("Ne pas émettre de son"),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(_,{keywords:["active","mute"],markerId:"9MxYVIf7k","data-in-app-search-marker-id":"9MxYVIf7k"},{default:e(()=>[a(T,{k:"sound.useSoundOnlyWhenActive"},{default:e(()=>[a($,{modelValue:S(F),"onUpdate:modelValue":l[1]||(l[1]=s=>U(F)?F.value=s:null)},{label:e(()=>[a(v,null,{default:e(()=>[d(o("Émettre des sons uniquement quand Misskey est active"),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(_,{keywords:["volume","master"],markerId:"94afQxKat","data-in-app-search-marker-id":"94afQxKat"},{default:e(()=>[a(T,{k:"sound.masterVolume"},{default:e(()=>[a(O,{modelValue:S(M),"onUpdate:modelValue":l[2]||(l[2]=s=>U(M)?M.value=s:null),min:0,max:1,step:.05,textConverter:s=>`${Math.floor(s*100)}%`},{label:e(()=>[a(v,null,{default:e(()=>[d(o("Volume principal"),1)]),_:1})]),_:1},8,["modelValue","textConverter"])]),_:1})]),_:1}),a(ue,null,{label:e(()=>[d(o("Sons"),1)]),default:e(()=>[y("div",pe,[(x(!0),b(oe,null,ie(S(ee),s=>(x(),A(de,{key:s},{label:e(()=>[d(o({"note":"Nouvelle note","noteMy":"Ma note","notification":"Notifications","reaction":"Lors de la sélection de la réaction","chatMessage":"Chat Messages"}[s]),1)]),suffix:e(()=>[d(o(I(c.value[s].type)),1)]),default:e(()=>[(x(),A(re,null,{default:e(()=>[a(me,{def:c.value[s],onUpdate:B=>i(s,B)},null,8,["def","onUpdate"])]),fallback:e(()=>[a(p)]),_:2},1024))]),_:2},1024))),128))])]),_:1}),a(V,{danger:"",onClick:l[3]||(l[3]=s=>W())},{default:e(()=>[l[4]||(l[4]=y("i",{class:"ti ti-reload"},null,-1)),d(" "+o("Par défaut"),1)]),_:1})])]),_:1},8,["label"])}}});export{be as default};
