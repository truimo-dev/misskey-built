import{$ as v,P as z,v as E,L as u,bZ as k,bz as L,b_ as U,by as W,h as H,C as g,az as R,M as C,J as q}from"./3iSoGi4ic-DV-GuiCp.js";import{u as w}from"./3iSoGi4ic-B1GPmOGN.js";import{M as F}from"./3iSoGi4ic-mUIS9yQt.js";import{a as J,s as I}from"./3iSoGi4ic-Cx1VE20Y.js";import{b as X,a as b,m as Y,c as m,w as Z,z as p,k as G,f,i as s,h as _,p as l,l as o,C as x,B as d,E as y,t as K,j as M,D as Q,y as ee}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-CdSqfJMx.js";import"./3iSoGi4ic-Dv7rS4og.js";const te={class:"_spacer",style:{"--MI_SPACER-w":"800px"}},ae={key:0,class:"_gaps"},ie={class:"_panel"},se={key:0},le={key:1},ne={key:0,style:{"margin-left":"6px"}},oe={key:0,style:{"margin-left":"6px"}},he=X({__name:"clip",props:{clipId:{}},setup(P){const r=!v&&J(I,"clip")?I.clip:null,n=P,e=b(r),c=b(!1),$=Y(new z("clips/notes",{limit:10,canSearch:!0,computedParams:m(()=>({clipId:n.clipId}))})),N=m(()=>v&&e.value&&v.id===e.value.userId);Z(()=>n.clipId,async()=>{if(r&&r.id===n.clipId){e.value=r;return}e.value=await q("clips/show",{clipId:n.clipId}),c.value=e.value.isFavorited??!1},{immediate:!0}),ee("currentClip",e);function A(){u("clips/favorite",{clipId:n.clipId}).then(()=>{c.value=!0})}async function S(){(await g({type:"warning",text:"¿Desea quitar de favoritos?"})).canceled||u("clips/unfavorite",{clipId:n.clipId}).then(()=>{c.value=!1})}const T=m(()=>e.value&&N.value?[{icon:"ti ti-pencil",text:"Editar",handler:async()=>{if(e.value==null)return;const{canceled:i,result:t}=await E(e.value.name,{name:{type:"string",label:"Nombre",default:e.value.name},description:{type:"string",required:!1,multiline:!0,treatAsMfm:!0,label:"Descripción",default:e.value.description},isPublic:{type:"boolean",label:"Público",default:e.value.isPublic}});i||(u("clips/update",{clipId:e.value.id,...t}),k.delete())}},...e.value.isPublic?[{icon:"ti ti-share",text:"Compartir",handler:i=>{const t=[];t.push({icon:"ti ti-link",text:"Copiar URL",action:()=>{L(`${w}/clips/${e.value.id}`)}},{icon:"ti ti-code",text:"Insertar",action:()=>{U("clips",e.value.id)}}),W()&&t.push({icon:"ti ti-share",text:"Compartir",action:async()=>{navigator.share({title:e.value.name,text:e.value.description??"",url:`${w}/clips/${e.value.id}`})}}),H(t,i.currentTarget??i.target)}}]:[],{icon:"ti ti-trash",text:"Borrar",danger:!0,handler:async()=>{if(e.value==null)return;const{canceled:i}=await g({type:"warning",text:(({x})=>("¿Desea borrar \""+x+"\"?"))({x:e.value.name})});i||(await u("clips/delete",{clipId:e.value.id}),k.delete())}}]:null);return R(()=>({title:e.value?e.value.name:"Clip",icon:"ti ti-paperclip"})),(i,t)=>{const B=p("Mfm"),D=p("MkAvatar"),V=p("MkUserName"),j=p("PageWithHeader"),h=G("tooltip");return s(),f(j,{actions:T.value},{default:_(()=>[l("div",te,[e.value?(s(),o("div",ae,[l("div",ie,[l("div",{class:"_gaps_s xjjVO"},[e.value.description?(s(),o("div",se,[d(B,{text:e.value.description,isNote:!1},null,8,["text"])])):(s(),o("div",le,"("+y("No hay descripción")+")",1)),l("div",null,[c.value?M((s(),f(C,{key:0,asLike:"",rounded:"",primary:"",onClick:t[0]||(t[0]=O=>S())},{default:_(()=>[t[2]||(t[2]=l("i",{class:"ti ti-heart"},null,-1)),e.value.favoritedCount>0?(s(),o("span",ne,y(e.value.favoritedCount),1)):x("",!0)]),_:1})),[[h,"Quitar de favoritos"]]):M((s(),f(C,{key:1,asLike:"",rounded:"",onClick:t[1]||(t[1]=O=>A())},{default:_(()=>[t[3]||(t[3]=l("i",{class:"ti ti-heart"},null,-1)),e.value.favoritedCount>0?(s(),o("span",oe,y(e.value.favoritedCount),1)):x("",!0)]),_:1})),[[h,"Añadir a favoritos"]])])],2),l("div",{class:"xxO3p"},[d(D,{user:e.value.user,class:"x7MT8",indicator:"",link:"",preview:""},null,8,["user","class"]),t[4]||(t[4]=Q()),d(V,{user:e.value.user,nowrap:!1},null,8,["user"])],2)]),d(F,{paginator:K($),detail:!0},null,8,["paginator"])])):x("",!0)])]),_:1},8,["actions"])}}});export{he as default};
