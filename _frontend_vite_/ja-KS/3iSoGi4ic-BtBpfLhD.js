import{Q as F,ak as Q,P as G,az as H,a7 as J,ab as O,M as x,aA as X,b$ as Y,L as b,h as P,J as k,C as j,N as B}from"./3iSoGi4ic-DV-GuiCp.js";import{M as q}from"./3iSoGi4ic-Cj3FgKaq.js";import{M as V}from"./3iSoGi4ic-Fx-BY70c.js";import{M as K}from"./3iSoGi4ic-CdSqfJMx.js";import{b as Z,a as g,m as ee,c as y,w as U,z as A,f as se,i as _,h as i,p as l,l as w,C as te,B as n,D as u,E as r,t as M,F as ae,A as ie}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-CS6W3O_2.js";import"./3iSoGi4ic-Dv7rS4og.js";const le={class:"_spacer",style:{"--MI_SPACER-w":"700px"}},ne={key:0,class:"_gaps"},oe={class:"_gaps"},ue={class:"_buttons"},re={class:"_gaps"},de={class:"_gaps_s"},ce=["onClick"],me=["onClick"],Me=Z({__name:"list",props:{listId:{}},setup($){const L=F(),C=Q(),h=$,e=g(null),d=g(!1),c=g(""),p=ee(new G("users/lists/get-memberships",{limit:30,computedParams:y(()=>({listId:h.listId}))}));function z(){k("users/lists/show",{listId:h.listId}).then(t=>{e.value=t,c.value=e.value.name,d.value=e.value.isPublic})}function R(){Y().then(t=>{e.value&&b("users/lists/push",{listId:e.value.id,userId:t.id}).then(()=>{p.reload()})})}async function S(t,s){P([{text:"ほかす",icon:"ti ti-x",danger:!0,action:async()=>{e.value&&k("users/lists/pull",{listId:e.value.id,userId:t.userId}).then(()=>{p.removeItem(t.id)})}}],s.currentTarget??s.target)}async function T(t,s){const v=g(t.withReplies);P([{type:"switch",text:"タイムラインに他の人への返信とかも入れるで",icon:"ti ti-messages",ref:v}],s.currentTarget??s.target),U(v,f=>{k("users/lists/update-membership",{listId:e.value.id,userId:t.userId,withReplies:f}).then(()=>{p.updateItem(t.id,o=>({...o,withReplies:f}))})})}async function N(){if(!e.value)return;const{canceled:t}=await j({type:"warning",text:(({x})=>("「"+x+"」はほかしてええか？"))({x:e.value.name})});t||(await b("users/lists/delete",{listId:e.value.id}),B.delete(),C.push("/my/lists"))}async function W(){e.value&&(await b("users/lists/update",{listId:e.value.id,name:c.value,isPublic:d.value}),B.delete(),e.value.name=c.value,e.value.isPublic=d.value)}U(()=>h.listId,z,{immediate:!0});const E=y(()=>e.value?[{icon:"ti ti-timeline",text:"タイムライン",handler:()=>{C.push("/timeline/list/:listId",{params:{listId:e.value.id}})}}]:[]),D=y(()=>[]);return H(()=>({title:e.value?e.value.name:"リスト",icon:"ti ti-list"})),(t,s)=>{const v=A("MkA"),f=A("PageWithHeader");return _(),se(f,{actions:E.value,tabs:D.value},{default:i(()=>[l("div",le,[e.value?(_(),w("div",ne,[n(V,null,{label:i(()=>[u(r("設定"),1)]),default:i(()=>[l("div",oe,[n(J,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=o=>c.value=o)},{label:i(()=>[u(r("名前"),1)]),_:1},8,["modelValue"]),n(O,{modelValue:d.value,"onUpdate:modelValue":s[1]||(s[1]=o=>d.value=o)},{default:i(()=>[u(r("パブリック"),1)]),_:1},8,["modelValue"]),l("div",ue,[n(x,{rounded:"",primary:"",onClick:W},{default:i(()=>[u(r("とっとく"),1)]),_:1}),n(x,{rounded:"",danger:"",onClick:s[2]||(s[2]=o=>N())},{default:i(()=>[u(r("ほかす"),1)]),_:1})])])]),_:1}),n(V,{defaultOpen:""},{label:i(()=>[u(r("メンバーはん"),1)]),caption:i(()=>[u(r((({n})=>(n+"ユーザー"))({n:`${e.value.userIds.length}/${M(L).policies.userEachUserListsLimit}`})),1)]),default:i(()=>[l("div",re,[n(x,{rounded:"",primary:"",style:{margin:"0 auto"},onClick:s[3]||(s[3]=o=>R())},{default:i(()=>[s[4]||(s[4]=l("i",{class:"ti ti-plus"},null,-1)),u(" "+r("ユーザーを追加や"),1)]),_:1}),n(K,{paginator:M(p)},{default:i(({items:o})=>[l("div",de,[(_(!0),w(ae,null,ie(o,m=>(_(),w("div",{key:m.id},[l("div",{class:"xmGzQ"},[n(v,{class:"xd8lu",to:`${M(X)(m.user)}`},{default:i(()=>[n(q,{user:m.user},null,8,["user"])]),_:2},1032,["class","to"]),l("button",{class:"_button xgcXW",onClick:I=>T(m,I)},[...s[5]||(s[5]=[l("i",{class:"ti ti-dots"},null,-1)])],10,ce),l("button",{class:"_button xBfwP",onClick:I=>S(m,I)},[...s[6]||(s[6]=[l("i",{class:"ti ti-x"},null,-1)])],10,me)],2)]))),128))])]),_:1},8,["paginator"])])]),_:1})])):te("",!0)])]),_:1},8,["actions","tabs"])}}});export{Me as default};
