import{c as X}from"./3iSoGi4ic-DUrJvqB4.js";import{aS as V,ag as T,M as R,Q as E,az as z,ab as q,L as y,J as x,C as J}from"./3iSoGi4ic-DV-GuiCp.js";import{b as A,c as v,l as O,i as h,B as o,f as N,C as Q,p,t as i,R as B,h as t,D as n,E as a,u as W,ab as Y,z as I,F as j,A as G}from"./3iSoGi4ic-D0mTJ0Mu.js";import{F as H}from"./3iSoGi4ic-CaDkpGcu.js";import{F as k}from"./3iSoGi4ic-BBsRrkiB.js";import{M as K}from"./3iSoGi4ic-Fx-BY70c.js";import{_ as Z}from"./3iSoGi4ic-1UQoJOkD.js";import{M as ee}from"./3iSoGi4ic-4oa2bN0A.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const te={class:"_gaps_m"},ie={class:"_buttons"},oe=["all","following","follower","mutualFollow","followingOrFollower","list","never"],se=A({__name:"notifications.notification-config",props:{value:{},userLists:{},configurableTypes:{}},emits:["update"],setup(L,{emit:m}){const u=L,l=m,b={all:"전체",following:"팔로잉",follower:"팔로워",mutualFollow:"맞팔로우",followingOrFollower:"팔로 중이거나 팔로워",list:"리스트",never:"없음"},{model:c,def:_}=V({items:v(()=>(u.configurableTypes??oe).map(f=>({label:b[f],value:f}))),initialValue:u.value.type}),{model:r,def:F}=V({items:v(()=>u.userLists.map(f=>({label:f.name,value:f.id}))),initialValue:u.value.type==="list"?u.value.userListId:null});function M(){l("update",c.value==="list"?{type:c.value,userListId:r.value}:{type:c.value})}return(f,d)=>(h(),O("div",te,[o(T,{modelValue:i(c),"onUpdate:modelValue":d[0]||(d[0]=w=>B(c)?c.value=w:null),items:i(_)},null,8,["modelValue","items"]),i(c)==="list"?(h(),N(T,{key:0,modelValue:i(r),"onUpdate:modelValue":d[1]||(d[1]=w=>B(r)?r.value=w:null),items:i(F)},{label:t(()=>[n(a("리스트"),1)]),_:1},8,["modelValue","items"])):Q("",!0),p("div",ie,[o(R,{inline:"",primary:"",disabled:i(c)==="list"&&i(r)===null,onClick:M},{default:t(()=>[d[2]||(d[2]=p("i",{class:"ti ti-check"},null,-1)),n(" "+a("저장"),1)]),_:1},8,["disabled"])])]))}}),ne={class:"_gaps_m"},ae={class:"_gaps_s"},le={class:"_gaps_m"},ce={class:"_gaps_s"},re={class:"_gaps_m"},ye=A({__name:"notifications",async setup(L){let m,u;const l=E(),b=["note","roleAssigned","followRequestAccepted","test","exportCompleted"],c=["app","achievementEarned","login","createToken","scheduledNotePosted","scheduledNotePostFailed"],_=W("allowButton"),r=v(()=>_.value?.pushRegistrationInServer),F=v(()=>r.value?.sendReadMessage||!1),M=([m,u]=Y(()=>x("users/lists/list")),m=await m,u(),m);async function f(){await y("notifications/mark-all-as-read",{})}async function d(g,C){await y("i/update",{notificationRecieveConfig:{...l.notificationRecieveConfig,[g]:C}}).then(S=>{l.notificationRecieveConfig=S.notificationRecieveConfig})}function w(g){r.value&&y("sw/update-registration",{endpoint:r.value.endpoint,sendReadMessage:g}).then(C=>{_.value&&(_.value.pushRegistrationInServer=C)})}function D(){x("notifications/test-notification")}async function P(){const{canceled:g}=await J({type:"warning",text:"초기화 하시겠습니까?"});g||y("notifications/flush",{})}return v(()=>[]),v(()=>[]),z(()=>({title:"알림",icon:"ti ti-bell"})),(g,C)=>{const S=I("SearchText"),U=I("SearchMarker");return h(),N(U,{path:"/settings/notifications",label:"알림",keywords:["notifications"],icon:"ti ti-bell",markerId:"8XIyos6Xv","data-in-app-search-marker-id":"8XIyos6Xv"},{default:t(()=>[p("div",ne,[o(ee,{icon:"/client-assets/bell_3d.png",color:"#ffff00"},{default:t(()=>[o(S,null,{default:t(()=>[n(a("서버에서 받는 알림의 종류 및 범위, 푸시 알림 설정을 합니다."),1)]),_:1})]),_:1}),o(k,{first:""},{label:t(()=>[n(a("알림 설정"),1)]),default:t(()=>[p("div",ae,[(h(!0),O(j,null,G(i(X).filter(s=>!b.includes(s)),s=>(h(),N(K,{key:s},{label:t(()=>[n(a({"all":"전부","note":"유저의 새 글","follow":"팔로잉","mention":"멘션","reply":"답글","renote":"리노트","quote":"인용","reaction":"리액션","pollEnded":"투표가 종료됨","scheduledNotePosted":"예약 게시에 성공했습니다","scheduledNotePostFailed":"예약 게시에 실패했습니다","receiveFollowRequest":"팔로우 요청을 받았을 때","followRequestAccepted":"팔로우 요청이 승인되었을 때","roleAssigned":"역할이 부여됨","chatRoomInvitationReceived":"채팅 룸에 초대받음","achievementEarned":"도전 과제 획득","exportCompleted":"추출을 성공함","login":"로그인","createToken":"액세스 토큰 만들기","test":"알림 테스트","app":"연동된 앱을 통한 알림"}[s]),1)]),suffix:t(()=>[n(a(i(l).notificationRecieveConfig[s]?.type==="never"?"없음":i(l).notificationRecieveConfig[s]?.type==="following"?"팔로잉":i(l).notificationRecieveConfig[s]?.type==="follower"?"팔로워":i(l).notificationRecieveConfig[s]?.type==="mutualFollow"?"맞팔로우":i(l).notificationRecieveConfig[s]?.type==="followingOrFollower"?"팔로 중이거나 팔로워":i(l).notificationRecieveConfig[s]?.type==="list"?"리스트":"전체"),1)]),default:t(()=>[o(se,{userLists:i(M),value:i(l).notificationRecieveConfig[s]??{type:"all"},configurableTypes:c.includes(s)?["all","never"]:void 0,onUpdate:$=>d(s,$)},null,8,["userLists","value","configurableTypes","onUpdate"])]),_:2},1024))),128))])]),_:1}),o(k,null,{default:t(()=>[p("div",le,[o(H,{to:"/settings/sounds"},{default:t(()=>[n(a("알림 설정"),1)]),_:1})])]),_:1}),o(k,null,{default:t(()=>[p("div",ce,[o(R,{onClick:f},{default:t(()=>[n(a("모든 알림을 읽은 상태로 표시"),1)]),_:1}),o(R,{onClick:D},{default:t(()=>[n(a("테스트 알림 보내기"),1)]),_:1}),o(R,{onClick:P},{default:t(()=>[n(a("알림 이력을 초기화"),1)]),_:1})])]),_:1}),o(k,null,{label:t(()=>[n(a("푸시 알림"),1)]),default:t(()=>[p("div",re,[o(Z,{ref_key:"allowButton",ref:_},null,512),o(q,{disabled:!r.value,modelValue:F.value,"onUpdate:modelValue":w},{label:t(()=>[n(a("푸시 알림이나 메시지를 읽은 뒤 푸시 알림을 삭제"),1)]),caption:t(()=>[n(a("「{emptyPushNotificationMessage}」이라는 알림이 잠깐 표시됩니다. 기기의 전력 소비량이 증가할 수 있습니다."),1)]),_:1},8,["disabled","modelValue"])])]),_:1})])]),_:1},8,["label"])}}});export{ye as default};
