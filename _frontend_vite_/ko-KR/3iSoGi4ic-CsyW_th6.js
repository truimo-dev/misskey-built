import{M,a5 as g,C as h,J as _,a6 as b,$ as B}from"./3iSoGi4ic-DV-GuiCp.js";import{b as T,u as d,a as A,e as R,z as $,f as D,i as a,h as v,p as n,l as m,C as I,E as p,B as k,D as q}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const w={key:0,class:"ti ti-info-circle"},H={key:1,class:"ti ti-alert-triangle",style:{color:"var(--MI_THEME-warn)"}},N={key:2,class:"ti ti-circle-x",style:{color:"var(--MI_THEME-error)"}},P={key:3,class:"ti ti-check",style:{color:"var(--MI_THEME-success)"}},G=T({__name:"MkAnnouncementDialog",props:{announcement:{}},setup(e){const c=e,o=d("rootEl"),r=d("bottomEl"),f=d("modal");async function y(){c.announcement.needConfirmationToRead&&(await h({type:"question",title:"읽음으로 표시합니까?",text:(({title})=>("〈"+title+"〉의 내용을 읽음으로 표시합니다."))({title:c.announcement.title})})).canceled||(f.value?.close(),_("i/read-announcement",{announcementId:c.announcement.id}),b({unreadAnnouncements:B.unreadAnnouncements.filter(t=>t.id!==c.announcement.id)}))}function C(){o.value?.animate([{offset:0,transform:"scale(1)"},{offset:.5,transform:"scale(1.1)"},{offset:1,transform:"scale(1)"}],{duration:100})}const i=A(!1);return R(()=>{if(r.value&&o.value){const t=r.value.getBoundingClientRect(),s=o.value.getBoundingClientRect();if(t.top>=s.top&&t.top<=s.bottom-66){i.value=!0;return}const l=new IntersectionObserver(x=>{for(const E of x)E.isIntersecting&&(i.value=!0,l.disconnect())},{root:o.value,rootMargin:"0px 0px -75px 0px"});l.observe(r.value)}}),(t,s)=>{const l=$("Mfm");return a(),D(g,{ref_key:"modal",ref:f,zPriority:"middle",preferType:"dialog",onClosed:s[0]||(s[0]=x=>t.$emit("closed")),onClick:C},{default:v(()=>[n("div",{ref_key:"rootEl",ref:o,class:"x82oh"},[n("div",{class:"xtqp4"},[n("span",{class:"xjCxd"},[e.announcement.icon==="info"?(a(),m("i",w)):e.announcement.icon==="warning"?(a(),m("i",H)):e.announcement.icon==="error"?(a(),m("i",N)):e.announcement.icon==="success"?(a(),m("i",P)):I("",!0)],2),n("span",{class:"xqDhA"},p(e.announcement.title),3)],2),n("div",{class:"xnHEP"},[k(l,{text:e.announcement.text},null,8,["text"])],2),n("div",{ref_key:"bottomEl",ref:r},null,512),n("div",{class:"xdSLk"},[k(M,{primary:"",full:"",disabled:!i.value,onClick:y},{default:v(()=>[q(p(i.value?"닫기":"스크롤하여 닫기"),1)]),_:1},8,["disabled"])],2)],2)]),_:1},512)}}});export{G as default};
