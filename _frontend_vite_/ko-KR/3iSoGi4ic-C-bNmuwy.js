import{X as E}from"./3iSoGi4ic-DWKPLXFg.js";import{M as w}from"./3iSoGi4ic-Fx-BY70c.js";import{ak as F,P as N,az as X,M as x,R as z,C as L,L as k,b$ as O,E as U,h as J,J as Y}from"./3iSoGi4ic-DV-GuiCp.js";import{M as j}from"./3iSoGi4ic-Cj3FgKaq.js";import{M as q}from"./3iSoGi4ic-CdSqfJMx.js";import{b as G,m as K,c as v,a as Q,r as Z,ab as ee,z as _,f as M,i as u,h as n,p as s,B as l,D as d,E as r,t as te,l as p,F as se,A as ne,g as oe,C as ae}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-DUrJvqB4.js";import"./3iSoGi4ic-DqZTax7V.js";import"./3iSoGi4ic-BDF7xMl0.js";import"./3iSoGi4ic-CSc4cSLM.js";import"./3iSoGi4ic-D8UyQ0ea.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-CS6W3O_2.js";import"./3iSoGi4ic-Dv7rS4og.js";const ie={class:"_spacer",style:{"--MI_SPACER-w":"700px"}},le={class:"_gaps"},re={class:"_buttons"},ue={class:"_gaps"},de={class:"_gaps_s"},ce=["onClick"],me=["onClick"],pe={key:0},fe={key:1},Re=G({__name:"roles.role",props:{id:{}},async setup(h){let f,b;const C=F(),g=h,A=K(new N("admin/roles/users",{limit:20,computedParams:v(()=>g.id?{roleId:g.id}:void 0)})),m=Q([]),o=Z(([f,b]=ee(()=>Y("admin/roles/show",{roleId:g.id})),f=await f,b(),f));function P(){C.push("/admin/roles/:id/edit",{params:{id:o.id}})}async function B(){const{canceled:a}=await L({type:"warning",text:(({x})=>("\""+x+"\" 을(를) 삭제하시겠습니까?"))({x:o.name})});a||(await k("admin/roles/delete",{roleId:o.id}),C.push("/admin/roles"))}async function D(){const a=await O({includeSelf:!0}),{canceled:e,result:c}=await U({title:"기간"+": "+o.name,items:[{value:"indefinitely",label:"무기한"},{value:"oneHour",label:"1시간"},{value:"oneDay",label:"1일"},{value:"oneWeek",label:"일주일"},{value:"oneMonth",label:"1개월"}],default:"indefinitely"});if(e)return;const y=c==="indefinitely"?null:c==="oneHour"?Date.now()+1e3*60*60:c==="oneDay"?Date.now()+1e3*60*60*24:c==="oneWeek"?Date.now()+1e3*60*60*24*7:c==="oneMonth"?Date.now()+1e3*60*60*24*30:null;await k("admin/roles/assign",{roleId:o.id,userId:a.id,expiresAt:y})}async function H(a,e){J([{text:"할당 취소",icon:"ti ti-x",danger:!0,action:async()=>{await k("admin/roles/unassign",{roleId:o.id,userId:a.id})}}],e.currentTarget??e.target)}async function R(a){m.value.includes(a.id)?m.value=m.value.filter(e=>e!==a.id):m.value.push(a.id)}const S=v(()=>[]),T=v(()=>[]);return X(()=>({title:`${"역할"}: ${o.name}`,icon:"ti ti-badge"})),(a,e)=>{const c=_("MkResult"),y=_("MkA"),V=_("MkTime"),W=_("PageWithHeader");return u(),M(W,{actions:S.value,tabs:T.value},{default:n(()=>[s("div",ie,[s("div",le,[s("div",re,[l(x,{primary:"",rounded:"",onClick:P},{default:n(()=>[e[0]||(e[0]=s("i",{class:"ti ti-pencil"},null,-1)),d(" "+r("편집"),1)]),_:1}),l(x,{danger:"",rounded:"",onClick:B},{default:n(()=>[e[1]||(e[1]=s("i",{class:"ti ti-trash"},null,-1)),d(" "+r("삭제"),1)]),_:1})]),l(w,null,{icon:n(()=>[...e[2]||(e[2]=[s("i",{class:"ti ti-info-circle"},null,-1)])]),label:n(()=>[d(r("정보"),1)]),default:n(()=>[l(E,{modelValue:o,readonly:""},null,8,["modelValue"])]),_:1}),o.target==="manual"?(u(),M(w,{key:0,defaultOpen:""},{icon:n(()=>[...e[3]||(e[3]=[s("i",{class:"ti ti-users"},null,-1)])]),label:n(()=>[d(r("유저"),1)]),suffix:n(()=>[d(r(o.usersCount),1)]),default:n(()=>[s("div",ue,[l(x,{primary:"",rounded:"",onClick:D},{default:n(()=>[e[4]||(e[4]=s("i",{class:"ti ti-plus"},null,-1)),d(" "+r("할당"),1)]),_:1}),l(q,{paginator:te(A)},{empty:n(()=>[l(c,{type:"empty",text:"아무도 없습니다"},null,8,["text"])]),default:n(({items:$})=>[s("div",de,[(u(!0),p(se,null,ne($,i=>(u(),p("div",{key:i.user.id,class:oe(["xuXc0",{xhBd8:m.value.includes(i.id)}])},[s("div",{class:"xnvRm"},[l(y,{class:"xBH9y",to:`/admin/user/${i.user.id}`},{default:n(()=>[l(j,{user:i.user},null,8,["user"])]),_:2},1032,["class","to"]),s("button",{class:"_button xAcPu",onClick:I=>R(i)},[s("i",{class:"xfoCt ti ti-chevron-down"},null,2)],10,ce),s("button",{class:"_button xF6eH",onClick:I=>H(i.user,I)},[...e[5]||(e[5]=[s("i",{class:"ti ti-x"},null,-1)])],10,me)],2),m.value.includes(i.id)?(u(),p("div",{key:0,class:"x8t2r"},[s("div",null,[e[6]||(e[6]=d("Assigned: ",-1)),l(V,{time:i.createdAt,mode:"detail"},null,8,["time"])]),i.expiresAt?(u(),p("div",pe,"Period: "+r(new Date(i.expiresAt).toLocaleString()),1)):(u(),p("div",fe,"Period: "+r("무기한"),1))],2)):ae("",!0)],2))),128))])]),_:1},8,["paginator"])])]),_:1})):(u(),M(z,{key:1},{default:n(()=>[d(r("조건부 역할입니다."),1)]),_:1}))])])]),_:1},8,["actions","tabs"])}}});export{Re as default};
