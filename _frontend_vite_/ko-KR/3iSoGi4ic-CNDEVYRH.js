import{aS as W,az as z,R as M,ag as O,a7 as T,ab as h,M as k,l as J,C as Y,J as y,L as g}from"./3iSoGi4ic-DV-GuiCp.js";import{_ as E}from"./3iSoGi4ic-Dz5OvLqt.js";import{M as j}from"./3iSoGi4ic-Fx-BY70c.js";import{M as q}from"./3iSoGi4ic-BDF7xMl0.js";import{b as G,a as C,w as K,c as b,z as w,f as m,i as r,h as a,p as o,B as u,C as p,l as v,D as n,E as s,t as A,R as Q,F as I,A as X}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-CZYXc2mx.js";const Z={class:"_spacer",style:{"--MI_SPACER-w":"900px"}},ee={class:"_gaps"},te={key:0,class:"ti ti-info-circle"},le={key:1,class:"ti ti-alert-triangle",style:{color:"var(--MI_THEME-warn)"}},ae={key:2,class:"ti ti-circle-x",style:{color:"var(--MI_THEME-error)"}},se={key:3,class:"ti ti-check",style:{color:"var(--MI_THEME-success)"}},ie={class:"_buttons"},oe={class:"_gaps"},de={value:"normal"},ne={value:"banner"},re={value:"dialog"},ue={key:1},xe=G({__name:"announcements",setup(ce){const{model:f,def:R}=W({items:[{label:"최근에 활동함",value:"active"},{label:"아카이브 됨",value:"archived"}],initialValue:"active"}),_=C(!0),x=C(!1),c=C([]);K(f,i=>{_.value=!0,y("admin/announcements/list",{status:i}).then(l=>{c.value=l,_.value=!1})},{immediate:!0});function S(){c.value.unshift({_id:J(),id:null,title:"New announcement",text:"",imageUrl:null,icon:"info",display:"normal",forExistingUsers:!1,silence:!1,needConfirmationToRead:!1})}function B(i){Y({type:"warning",text:(({x})=>("\""+x+"\" 을(를) 삭제하시겠습니까?"))({x:i.title})}).then(({canceled:l})=>{l||(c.value=c.value.filter(V=>V!==i),y("admin/announcements/delete",i))})}async function D(i){await g("admin/announcements/update",{...i,isActive:!1}),U()}async function H(i){await g("admin/announcements/update",{...i,isActive:!0}),U()}async function P(i){i.id==null?(await g("admin/announcements/create",i),U()):g("admin/announcements/update",i)}function N(){x.value=!0,y("admin/announcements/list",{status:f.value,untilId:c.value.reduce((i,l)=>l.id!=null?l:i).id}).then(i=>{c.value=c.value.concat(i),x.value=!1})}function U(){_.value=!0,y("admin/announcements/list",{status:f.value}).then(i=>{c.value=i,_.value=!1})}const $=b(()=>[{asFullButton:!0,icon:"ti ti-plus",text:"추가",handler:S,disabled:f.value==="archived"}]),F=b(()=>[]);return z(()=>({title:"공지사항",icon:"ti ti-speakerphone"})),(i,l)=>{const V=w("MkLoading"),L=w("PageWithHeader");return r(),m(L,{actions:$.value,tabs:F.value},{default:a(()=>[o("div",Z,[o("div",ee,[u(M,null,{default:a(()=>[n(s("신규 유저의 이용 경험에 악영향을 끼칠 수 있으므로, 일시적인 알림 수단으로만 사용하고 고정된 정보에는 사용을 지양하는 것을 추천합니다."),1)]),_:1}),c.value.length>5?(r(),m(M,{key:0,warn:""},{default:a(()=>[n(s("공지사항이 너무 많을 경우, 유저 경험에 영향을 끼칠 가능성이 있습니다. 오래된 공지사항은 아카이브하시는 것을 권장드립니다."),1)]),_:1})):p("",!0),u(O,{modelValue:A(f),"onUpdate:modelValue":l[0]||(l[0]=e=>Q(f)?f.value=e:null),items:A(R)},{label:a(()=>[n(s("필터"),1)]),_:1},8,["modelValue","items"]),_.value?(r(),m(V,{key:1})):(r(),v(I,{key:2},[(r(!0),v(I,null,X(c.value,e=>(r(),m(j,{key:e.id??e._id,defaultOpen:e.id==null},{label:a(()=>[n(s(e.title),1)]),icon:a(()=>[e.icon==="info"?(r(),v("i",te)):e.icon==="warning"?(r(),v("i",le)):e.icon==="error"?(r(),v("i",ae)):e.icon==="success"?(r(),v("i",se)):p("",!0)]),caption:a(()=>[n(s(e.text),1)]),footer:a(()=>[o("div",ie,[u(k,{rounded:"",primary:"",onClick:d=>P(e)},{default:a(()=>[l[2]||(l[2]=o("i",{class:"ti ti-device-floppy"},null,-1)),n(" "+s("저장"),1)]),_:1},8,["onClick"]),e.id!=null&&e.isActive?(r(),m(k,{key:0,rounded:"",onClick:d=>D(e)},{default:a(()=>[l[3]||(l[3]=o("i",{class:"ti ti-check"},null,-1)),n(" "+s("공지에서 내리기")+" ("+s("아카이브")+")",1)]),_:1},8,["onClick"])):p("",!0),e.id!=null&&!e.isActive?(r(),m(k,{key:1,rounded:"",onClick:d=>H(e)},{default:a(()=>[l[4]||(l[4]=o("i",{class:"ti ti-restore"},null,-1)),n(" "+s("보관 취소"),1)]),_:1},8,["onClick"])):p("",!0),e.id!=null?(r(),m(k,{key:2,rounded:"",danger:"",onClick:d=>B(e)},{default:a(()=>[l[5]||(l[5]=o("i",{class:"ti ti-trash"},null,-1)),n(" "+s("삭제"),1)]),_:1},8,["onClick"])):p("",!0)])]),default:a(()=>[o("div",oe,[u(T,{modelValue:e.title,"onUpdate:modelValue":d=>e.title=d},{label:a(()=>[n(s("제목"),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),u(q,{modelValue:e.text,"onUpdate:modelValue":d=>e.text=d,mfmAutocomplete:"",mfmPreview:!0},{label:a(()=>[n(s("텍스트"),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),u(T,{modelValue:e.imageUrl,"onUpdate:modelValue":d=>e.imageUrl=d,type:"url"},{label:a(()=>[n(s("이미지 URL"),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),u(E,{modelValue:e.icon,"onUpdate:modelValue":d=>e.icon=d},{label:a(()=>[n(s("아바타"),1)]),default:a(()=>[l[6]||(l[6]=o("option",{value:"info"},[o("i",{class:"ti ti-info-circle"})],-1)),l[7]||(l[7]=o("option",{value:"warning"},[o("i",{class:"ti ti-alert-triangle",style:{color:"var(--MI_THEME-warn)"}})],-1)),l[8]||(l[8]=o("option",{value:"error"},[o("i",{class:"ti ti-circle-x",style:{color:"var(--MI_THEME-error)"}})],-1)),l[9]||(l[9]=o("option",{value:"success"},[o("i",{class:"ti ti-check",style:{color:"var(--MI_THEME-success)"}})],-1))]),_:1},8,["modelValue","onUpdate:modelValue"]),u(E,{modelValue:e.display,"onUpdate:modelValue":d=>e.display=d},{label:a(()=>[n(s("보기"),1)]),default:a(()=>[o("option",de,s("일반"),1),o("option",ne,s("배너"),1),o("option",re,s("다이얼로그"),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),e.display==="dialog"?(r(),m(M,{key:0,warn:""},{default:a(()=>[n(s("다이얼로그 형태의 알림이 동시에 2개 이상 존재하는 경우, 유저 경험에 악영향을 끼칠 수 있으므로 신중히 결정하십시오."),1)]),_:1})):p("",!0),u(h,{modelValue:e.forExistingUsers,"onUpdate:modelValue":d=>e.forExistingUsers=d,helpText:"활성화하면 이 공지사항을 게시한 시점에서 이미 가입한 유저에게만 표시합니다. 비활성화하면 게시 후에 가입한 유저에게도 표시합니다."},{default:a(()=>[n(s("기존 유저에게만 알림"),1)]),_:1},8,["modelValue","onUpdate:modelValue","helpText"]),u(h,{modelValue:e.silence,"onUpdate:modelValue":d=>e.silence=d,helpText:"활성화하면 공지사항에 대한 알림이 가지 않게 되며, 확인 버튼을 누를 필요가 없게 됩니다."},{default:a(()=>[n(s("조용히 알림"),1)]),_:1},8,["modelValue","onUpdate:modelValue","helpText"]),u(h,{modelValue:e.needConfirmationToRead,"onUpdate:modelValue":d=>e.needConfirmationToRead=d,helpText:"활성화하면 이 공지사항을 읽음으로 표시하기 전에 확인 알림창을 띄웁니다. '모두 읽음'의 대상에서도 제외됩니다."},{default:a(()=>[n(s("읽음으로 표시하기 전에 확인하기"),1)]),_:1},8,["modelValue","onUpdate:modelValue","helpText"]),e.reads?(r(),v("p",ue,s((({n})=>(n+"명이 읽음"))({n:e.reads})),1)):p("",!0)])]),_:2},1032,["defaultOpen"]))),128)),x.value?(r(),m(V,{key:0})):p("",!0),u(k,{onClick:l[1]||(l[1]=e=>N())},{default:a(()=>[l[10]||(l[10]=o("i",{class:"ti ti-reload"},null,-1)),n(s("더 보기!"),1)]),_:1})],64))])])]),_:1},8,["actions","tabs"])}}});export{xe as default};
