import{aS as k,P as R,az as H,M as L,ag as y,a7 as D,b$ as T,k as U,L as q,x as J}from"./3iSoGi4ic-DV-GuiCp.js";import{M as j}from"./3iSoGi4ic-CdSqfJMx.js";import{l as G}from"./3iSoGi4ic-_4H1QviN.js";import{M as K}from"./3iSoGi4ic-Cj3FgKaq.js";import{d as X}from"./3iSoGi4ic-y3_HjM0O.js";import{b as Y,a as S,m as Z,c as M,aB as ee,z as $,k as te,f as A,i as V,h as l,p as c,B as n,D as i,E as p,t as o,R as w,l as se,F as ae,A as le,j as oe}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-Dv7rS4og.js";import"./3iSoGi4ic-CS6W3O_2.js";class re{storage;constructor(){this.storage=new Map}has(s){return this.storage.has(s)}getItem(s){return this.storage.has(s)?this.storage.get(s):null}setItem(s,r){this.storage.set(s,r)}removeItem(s){this.storage.delete(s)}clear(){this.storage.clear()}get size(){return this.storage.size}}function ne(){return new re}const P=ne(),ie={class:"_spacer",style:{"--MI_SPACER-w":"900px"}},ue={class:"_gaps"},Ve=Y({__name:"users",setup(B){const s=JSON.parse(P.getItem("admin-users-query")??"{}"),{model:r,def:I}=k({items:[{label:`${"註冊日期"} (${"昇冪"})`,value:"-createdAt"},{label:`${"註冊日期"} (${"降冪"})`,value:"+createdAt"},{label:`${"上次使用"} (${"昇冪"})`,value:"-updatedAt"},{label:`${"上次使用"} (${"降冪"})`,value:"+updatedAt"}],initialValue:s.sort??"+createdAt"}),{model:u,def:W}=k({items:[{label:"全部",value:"all"},{label:"正常",value:"available"},{label:"管理員",value:"admin"},{label:"審查員",value:"moderator"},{label:"凍結",value:"suspended"}],initialValue:s.state??"all"}),{model:d,def:C}=k({items:[{label:"全部",value:"combined"},{label:"本地",value:"local"},{label:"遠端",value:"remote"}],initialValue:s.origin??"local"}),v=S(s.username??""),f=S(s.hostname??""),x=Z(new R("admin/show-users",{limit:10,computedParams:M(()=>({sort:r.value,state:u.value,origin:d.value,username:v.value,hostname:f.value})),offsetMode:!0}));function O(){T({includeSelf:!0}).then(m=>{z(m)})}async function Q(){const{canceled:m,result:t}=await U({title:"使用者名稱"});if(m||t==null)return;const{canceled:b,result:h}=await U({title:"密碼",type:"password"});b||h==null||q("admin/accounts/create",{username:t,password:h}).then(_=>{x.reload()})}function z(m){J(`/admin/user/${m.id}`)}function N(){r.value="+createdAt",u.value="all",d.value="local",v.value="",f.value=""}const E=M(()=>[{icon:"ti ti-search",text:"搜尋",handler:O},{asFullButton:!0,icon:"ti ti-plus",text:"新增使用者",handler:Q},{asFullButton:!0,icon:"ti ti-search",text:"查詢",handler:G}]),F=M(()=>[]);return ee(()=>{P.setItem("admin-users-query",JSON.stringify({sort:r.value,state:u.value,origin:d.value,username:v.value,hostname:f.value}))}),H(()=>({title:"使用者",icon:"ti ti-users"})),(m,t)=>{const b=$("MkA"),h=$("PageWithHeader"),_=te("tooltip");return V(),A(h,{actions:E.value,tabs:F.value},{default:l(()=>[c("div",ie,[c("div",ue,[c("div",{class:"x2DQW"},[n(L,{style:{"margin-left":"auto"},onClick:N},{default:l(()=>[i(p("重設"),1)]),_:1})],2),c("div",{class:"x2DQW"},[n(y,{modelValue:o(r),"onUpdate:modelValue":t[0]||(t[0]=a=>w(r)?r.value=a:null),items:o(I),style:{flex:"1"}},{label:l(()=>[i(p("排序"),1)]),_:1},8,["modelValue","items"]),n(y,{modelValue:o(u),"onUpdate:modelValue":t[1]||(t[1]=a=>w(u)?u.value=a:null),items:o(W),style:{flex:"1"}},{label:l(()=>[i(p("狀態"),1)]),_:1},8,["modelValue","items"]),n(y,{modelValue:o(d),"onUpdate:modelValue":t[2]||(t[2]=a=>w(d)?d.value=a:null),items:o(C),style:{flex:"1"}},{label:l(()=>[i(p("伺服器"),1)]),_:1},8,["modelValue","items"])],2),c("div",{class:"x2DQW"},[n(D,{modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=a=>v.value=a),style:{flex:"1"},type:"text",spellcheck:!1},{prefix:l(()=>[...t[5]||(t[5]=[i("@",-1)])]),label:l(()=>[i(p("使用者名稱"),1)]),_:1},8,["modelValue"]),n(D,{modelValue:f.value,"onUpdate:modelValue":t[4]||(t[4]=a=>f.value=a),style:{flex:"1"},type:"text",spellcheck:!1,disabled:o(x).computedParams?.value?.origin==="local"},{prefix:l(()=>[...t[6]||(t[6]=[i("@",-1)])]),label:l(()=>[i(p("主機"),1)]),_:1},8,["modelValue","disabled"])],2),n(j,{paginator:o(x)},{default:l(({items:a})=>[c("div",{class:"xs3ks"},[(V(!0),se(ae,null,le(a,g=>oe((V(),A(b,{key:g.id,class:"xDSPM",to:`/admin/user/${g.id}`},{default:l(()=>[n(K,{user:g},null,8,["user"])]),_:2},1032,["class","to"])),[[_,`Last posted: ${g.updatedAt?o(X)(g.updatedAt):"Unknown"}`,void 0,{mfm:!0}]])),128))],2)]),_:1},8,["paginator"])])])]),_:1},8,["actions","tabs"])}}});export{Ve as default};
