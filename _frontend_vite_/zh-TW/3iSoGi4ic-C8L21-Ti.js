import{$ as t,i as m,P as I,az as A,M as B,J as C,A as b}from"./3iSoGi4ic-DV-GuiCp.js";import{M as E}from"./3iSoGi4ic-CdSqfJMx.js";import{M as N}from"./3iSoGi4ic-BwSG5_YJ.js";import{b as V,a as D,m as S,c as z,z as g,f as h,i as n,h as u,l,t as s,B as d,p,C as M,E as _,D as F,F as H,A as W}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-Dv7rS4og.js";import"./3iSoGi4ic-Fx-BY70c.js";const $={key:0,class:"_spacer",style:{"--MI_SPACER-w":"1200px"}},J={key:1,class:"_spacer",style:{"--MI_SPACER-w":"800px"}},T={class:"_gaps_m",style:{"text-align":"center"}},j={key:0},q={key:1},G={class:"_gaps_s"},ne=V({__name:"invite",setup(K){const o=D(null),v=t!=null&&t.policies.inviteLimit||t==null&&m.policies.inviteLimit,f=t!=null&&t.policies.inviteLimitCycle||t==null&&m.policies.inviteLimitCycle,r=S(new I("invite/list",{limit:10})),y=z(()=>{if(!f)return null;const e=f;if(e<60)return e+"分鐘";const a=Math.floor(e/60);return a<24?a+"小時":Math.floor(a/24)+"日"});async function x(){const e=await C("invite/create");b({type:"success",title:"已建立邀請碼",text:e.code}),r.prepend(e),c()}function L(e){r.removeItem(e),c()}async function c(){o.value=(await C("invite/limit")).remaining}return c(),A(()=>({title:"邀請",icon:"ti ti-user-plus"})),(e,a)=>{const P=g("MkResult"),R=g("PageWithHeader");return n(),h(R,null,{default:u(()=>[!s(m).disableRegistration||!(s(t)&&(s(t).isAdmin||s(t).policies.canInvite))?(n(),l("div",$,[d(P,{type:"empty"})])):(n(),l("div",J,[p("div",T,[y.value&&s(v)?(n(),l("div",j,_((({time,limit})=>("可以在 "+time+" 內建立最多 "+limit+" 個邀請碼。"))({time:y.value,limit:s(v)})),1)):M("",!0),d(B,{inline:"",primary:"",rounded:"",disabled:o.value!==null&&o.value<=0,onClick:x},{default:u(()=>[a[0]||(a[0]=p("i",{class:"ti ti-user-plus"},null,-1)),F(" "+_("建立邀請碼"),1)]),_:1},8,["disabled"]),o.value!==null?(n(),l("div",q,_((({limit})=>("可建立的邀請碼：剩餘 "+limit+" 個"))({limit:o.value})),1)):M("",!0),d(E,{paginator:s(r)},{default:u(({items:w})=>[p("div",G,[(n(!0),l(H,null,W(w,k=>(n(),h(N,{key:k.id,invite:k,onDeleted:L},null,8,["invite"]))),128))])]),_:1},8,["paginator"])])]))]),_:1})}}});export{ne as default};
