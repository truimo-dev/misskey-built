const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-D6lvPj3q.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-DV-GuiCp.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-D0mTJ0Mu.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-B1GPmOGN.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-Dty8GuTz.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-D98_HDRS.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/assets/3iSoGi4ic-DZU1WGtr.css","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/assets/3iSoGi4ic-9GwroBN9.css"])))=>i.map(i=>d[i]);
import{ak as F,az as L,a7 as J,ab as A,M as f,e as K,J as y,k as j,L as C,C as q,W as G,af as Q}from"./3iSoGi4ic-DV-GuiCp.js";import{M as X}from"./3iSoGi4ic-DqZTax7V.js";import{M as Y}from"./3iSoGi4ic-Fx-BY70c.js";import{M as Z}from"./3iSoGi4ic-BDF7xMl0.js";import{b as ee,a as d,w as ne,c as B,z as le,f as g,i as h,h as s,p as a,l as M,C as N,B as u,D as o,E as i,t as te,d as ae}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const se={class:"_spacer",style:{"--MI_SPACER-w":"700px"}},oe={key:0,class:"_gaps_m"},ie={key:1},ue=["src"],de={class:"_gaps"},re=["onClick"],ce={class:"_buttons"},ye=ee({__name:"channel-editor",props:{channelId:{}},setup(I){const E=ae(()=>K(()=>import("./3iSoGi4ic-D6lvPj3q.js").then(n=>n.v),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url).then(n=>n.default)),T=F(),c=I,_=d(null),m=d(""),V=d(null),p=d(null),r=d(null),k=d("#000"),b=d(!1),x=d(!0),v=d([]);ne(()=>r.value,async()=>{r.value==null?p.value=null:p.value=(await y("drive/files/show",{fileId:r.value})).url});async function U(){if(c.channelId==null)return;const n=await y("channels/show",{channelId:c.channelId});m.value=n.name,V.value=n.description,r.value=n.bannerId,p.value=n.bannerUrl,b.value=n.isSensitive,v.value=n.pinnedNoteIds.map(e=>({id:e})),k.value=n.color,x.value=n.allowRenoteToExternal,_.value=n}U();async function P(){const{canceled:n,result:e}=await j({title:"貼文 ID 或 URL"});if(n||e==null)return;const w=e.includes("/")?e.split("/").pop():null,l=await C("notes/show",{noteId:w??e});v.value=[{id:l.id},...v.value]}function R(n){v.value.splice(n,1)}function S(){const n={name:m.value,description:V.value,bannerId:r.value,color:k.value,isSensitive:b.value,allowRenoteToExternal:x.value};c.channelId!=null?C("channels/update",{...n,channelId:c.channelId,pinnedNoteIds:v.value.map(e=>e.id)}):C("channels/create",n).then(e=>{T.push("/channels/:channelId",{params:{channelId:e.id}})})}async function W(){if(c.channelId==null)return;const{canceled:n}=await q({type:"warning",title:(({name})=>("要封存"+name+"嗎？"))({name:m.value}),text:"封存後，將不會在頻道列表與搜尋結果中顯示，也無法發佈新貼文。"});n||y("channels/update",{channelId:c.channelId,isArchived:!0}).then(()=>{G()})}function $(n){Q({anchorElement:n.currentTarget??n.target,multiple:!1}).then(e=>{r.value=e.id})}function D(){r.value=null}const H=B(()=>[]),z=B(()=>[]);return L(()=>({title:c.channelId?"編輯頻道":"建立頻道",icon:"ti ti-device-tv"})),(n,e)=>{const w=le("PageWithHeader");return h(),g(w,{actions:H.value,tabs:z.value},{default:s(()=>[a("div",se,[I.channelId==null||_.value!=null?(h(),M("div",oe,[u(J,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l)},{label:s(()=>[o(i("名稱"),1)]),_:1},8,["modelValue"]),u(Z,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=l=>V.value=l),mfmAutocomplete:"",mfmPreview:!0},{label:s(()=>[o(i("描述"),1)]),_:1},8,["modelValue"]),u(X,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=l=>k.value=l)},{label:s(()=>[o(i("顏色"),1)]),_:1},8,["modelValue"]),u(A,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=l=>b.value=l)},{label:s(()=>[o(i("敏感內容"),1)]),_:1},8,["modelValue"]),u(A,{modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=l=>x.value=l)},{label:s(()=>[o(i("允許在頻道外轉發和引用"),1)]),_:1},8,["modelValue"]),a("div",null,[r.value==null?(h(),g(f,{key:0,onClick:$},{default:s(()=>[e[10]||(e[10]=a("i",{class:"ti ti-plus"},null,-1)),o(" "+i("設定橫幅圖像"),1)]),_:1})):p.value?(h(),M("div",ie,[a("img",{src:p.value,style:{width:"100%"}},null,8,ue),u(f,{onClick:e[5]||(e[5]=l=>D())},{default:s(()=>[e[11]||(e[11]=a("i",{class:"ti ti-trash"},null,-1)),o(" "+i("移除橫幅圖像"),1)]),_:1})])):N("",!0)]),u(Y,{defaultOpen:!0},{label:s(()=>[o(i("已置頂的貼文"),1)]),default:s(()=>[a("div",de,[u(f,{primary:"",rounded:"",onClick:e[6]||(e[6]=l=>P())},{default:s(()=>[...e[12]||(e[12]=[a("i",{class:"ti ti-plus"},null,-1)])]),_:1}),u(te(E),{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=l=>v.value=l),itemKey:"id",handle:".xAWVg",animation:150},{item:s(({element:l,index:O})=>[a("div",{class:"xoA4a"},[a("button",{class:"_button xAWVg"},[...e[13]||(e[13]=[a("i",{class:"ti ti-menu"},null,-1)])],2),o(" "+i(l.id)+" ",1),a("button",{class:"_button xdBn1",onClick:ve=>R(O)},[...e[14]||(e[14]=[a("i",{class:"ti ti-x"},null,-1)])],10,re)],2)]),_:1},8,["modelValue","handle"])])]),_:1}),a("div",ce,[u(f,{primary:"",onClick:e[8]||(e[8]=l=>S())},{default:s(()=>[e[15]||(e[15]=a("i",{class:"ti ti-device-floppy"},null,-1)),o(" "+i(I.channelId?"儲存":"新增"),1)]),_:1}),I.channelId?(h(),g(f,{key:0,danger:"",onClick:e[9]||(e[9]=l=>W())},{default:s(()=>[e[16]||(e[16]=a("i",{class:"ti ti-trash"},null,-1)),o(" "+i("封存"),1)]),_:1})):N("",!0)])])):N("",!0)])]),_:1},8,["actions","tabs"])}}});export{ye as default};
