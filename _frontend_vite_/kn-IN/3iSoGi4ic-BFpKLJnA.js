import{I as K,r as C}from"./3iSoGi4ic-nJzNoieu.js";import{P as L}from"./3iSoGi4ic-KYydmxIu.js";import{M as g}from"./3iSoGi4ic-CC5SbM-1.js";import{a0 as M,az as N,M as R,$ as z,A as _,bj as Z}from"./3iSoGi4ic-DV-GuiCp.js";import{M as $}from"./3iSoGi4ic-BDF7xMl0.js";import{M as H}from"./3iSoGi4ic--zoJC9Uy.js";import{c as J,a as O}from"./3iSoGi4ic-CCt4ZT5M.js";import{M as q,r as F}from"./3iSoGi4ic-BgYi9BfU.js";import{b as G,a as m,w as Q,M as j,o as X,c as I,z as Y,f as b,i as r,h as i,p as o,C as D,B as v,g as P,D as k,l,F as U,A as V,E as c}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-C0O4p9AH.js";import"./3iSoGi4ic-Ddz4upM5.js";import"./3iSoGi4ic-ke9ZaMpT.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-DAn693fE.js";import"https://esm.sh/shiki@3.19.0/langs";import"https://esm.sh/shiki@3.19.0/themes";import"./3iSoGi4ic-Fx-BY70c.js";import"./3iSoGi4ic-DUrJvqB4.js";const ee={class:"_spacer",style:{"--MI_SPACER-w":"800px"}},te={class:"_gaps"},oe={class:"_gaps_s"},se=["onClick"],re={key:0,class:"ti ti-chevron-up icon"},ae={key:1,class:"ti ti-chevron-down icon"},ne={key:0},ie={class:""},Ve=G({__name:"scratchpad",setup(le){const A=new L;let a;const u=m(""),h=m([]),p=m(),d=m([]),w=m(0),x=m(new WeakMap),S=M.getItem("scratchpad");S&&(u.value=S),Q(u,()=>{M.setItem("scratchpad",u.value)});function B(n){return JSON.stringify({...n,type:void 0,id:void 0},(e,s)=>typeof s=="function"?"<function>":s,2)}async function E(){a&&a.abort(),p.value=void 0,d.value=[],w.value++,h.value=[],a=new K({...J({storageKey:"widget",token:z?.token}),...F(d.value,e=>{p.value=e.value})},{in:O,out:e=>{e.type==="str"&&e.value.toLowerCase().replace(",","").includes("hello world")&&Z("outputHelloWorldOnScratchpad"),h.value.push({id:Math.random(),text:e.type==="str"?e.value:C(e),print:!0})},err:e=>{_({type:"error",title:"AiScript Error",text:e.toString()})},log:(e,s)=>{switch(e){case"end":h.value.push({id:Math.random(),text:C(s.val,!0),print:!1});break}}});let n;try{n=A.parse(u.value)}catch(e){_({type:"error",title:"Syntax Error",text:e.toString()});return}try{await a.exec(n)}catch(e){_({type:"error",title:"Internal Error",text:e.toString()})}}j(()=>{a&&a.abort()}),X(()=>{a&&a.abort()}),I(()=>[]),I(()=>[]);const T=I(()=>{if(p.value==null)return new Set;const n=new Set;return(function e(s){n.add(s.id);const t=s.children;if(t){const W=d.value.filter(y=>t.includes(y.value.id));for(const y of W)e(y.value)}})(p.value),n});return N(()=>({title:"Scratchpad",icon:"ti ti-terminal-2"})),(n,e)=>{const s=Y("PageWithHeader");return r(),b(s,null,{default:i(()=>[o("div",ee,[o("div",te,[o("div",oe,[o("div",{class:"xmKKn _panel"},[v(H,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),lang:"aiscript"},null,8,["modelValue"])],2),v(R,{primary:"",onClick:e[1]||(e[1]=t=>E())},{default:i(()=>[...e[2]||(e[2]=[o("i",{class:"ti ti-player-play"},null,-1)])]),_:1})]),p.value&&d.value.length>1?(r(),b(g,{key:w.value,foldable:!0},{header:i(()=>[...e[3]||(e[3]=[k("UI",-1)])]),default:i(()=>[o("div",{class:"xfn4d"},[v(q,{component:p.value,components:d.value,size:"small"},null,8,["component","components"])],2)]),_:1})):D("",!0),v(g,{foldable:!0,class:""},{header:i(()=>[k(c("Output"),1)]),default:i(()=>[o("div",{class:"xsZBD"},[(r(!0),l(U,null,V(h.value,t=>(r(),l("div",{key:t.id,class:P(["log",{print:t.print}])},c(t.text),3))),128))],2)]),_:1}),v(g,{foldable:!0,expanded:!1},{header:i(()=>[k(c("UI inspector"),1)]),default:i(()=>[o("div",{class:"xhLWW"},[(r(!0),l(U,null,V(d.value,t=>(r(),l("div",{key:t.value.id,class:P({xspGq:!T.value.has(t.value.id)})},[o("div",{class:"xbe8l"},c(t.value.type),3),o("div",{class:"xxnQR"},c(t.value.id),3),o("button",{class:"xwD8e",onClick:()=>x.value.set(t,!x.value.get(t))},[x.value.get(t)?(r(),l("i",re)):(r(),l("i",ae))],10,se),x.value.get(t)?(r(),l("div",ne,[v($,{modelValue:B(t.value),code:"",readonly:""},null,8,["modelValue"])])):D("",!0)],2))),128)),o("div",{class:"xyJvZ"},c("You can see the UI component server list on memory. UI component will be generated by Ui:C: function."),3)],2)]),_:1}),o("div",ie,c("The Scratchpad provides an environment for AiScript experiments. You can write, execute, and check the results of it interacting with Misskey in it."),1)])])]),_:1})}}});export{Ve as default};
