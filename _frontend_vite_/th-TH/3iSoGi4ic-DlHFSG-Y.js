import{a7 as w,R as S,bl as D,ab as E,M as P,bm as Y,J as B,A as $}from"./3iSoGi4ic-DV-GuiCp.js";import{M as y}from"./3iSoGi4ic-Fx-BY70c.js";import{_ as T}from"./3iSoGi4ic-Dz5OvLqt.js";import{b as j,a as f,c as q,l as H,i as p,B as o,f as m,C as _,h as i,D as a,E as t,p as e}from"./3iSoGi4ic-D0mTJ0Mu.js";const J={class:"_gaps_s"},G={value:"single"},K={value:"group"},Q={value:"open"},X={class:"_gaps_s"},Z={value:"small"},h={value:"medium"},ee={value:"large"},le={class:"_gaps_s"},te={value:"yes"},se={value:"no"},ne={class:"_gaps_s"},ie={class:"_gaps_s"},_e=j({__name:"MkServerSetupWizard",props:{token:{}},emits:["finished"],setup(x,{emit:A}){const N=A,U=x,c=f(""),n=f("single"),g=f("small"),b=f("yes"),C=f(!0),k=f(""),z=f(""),r=q(()=>{let v;return n.value==="single"?v=!1:v=g.value!=="small",{singleUserMode:n.value==="single",disableRegistration:n.value!=="open",emailRequiredForSignup:n.value==="open",enableIpLogging:n.value==="open",federation:b.value==="yes"?"all":"none",enableRemoteNotesCleaning:C.value,enableFanoutTimeline:!0,enableFanoutTimelineDbFallback:n.value==="single",enableReactionsBuffering:v,clientOptions:{entrancePageStyle:n.value==="open"?"classic":"simple"}}}),d=q(()=>{let v;n.value==="single"?v=8192:n.value==="group"?v=1e3:n.value==="open"&&(v=100);let s;n.value==="single"?s=.3:n.value==="group"?s=.7:n.value==="open"&&(g.value==="small"?s=1:g.value==="medium"?s=1.25:g.value==="large"&&(s=1.5));let u;n.value==="single"?u=100:n.value==="group"?u=5:n.value==="open"&&(u=3);let M;n.value==="single"?M=100:n.value==="group"?M=5:n.value==="open"&&(M=0);let W;n.value==="single"?W=100:(n.value==="group"||n.value==="open")&&(W=0);let F;n.value==="single"?F=!0:F=!1;let V;n.value==="single"?V=!0:V=!1;let I;n.value==="single"?I=!0:I=!1;let R;n.value==="single"?R=!0:R=!1;let L;return n.value==="single"?L=!0:L=!1,{rateLimitFactor:s,driveCapacityMb:v,userListLimit:u,antennaLimit:M,webhookLimit:W,canImportFollowing:F,canImportMuting:V,canImportBlocking:I,canImportUserLists:R,canImportAntennas:L}});function O(){const v=Y();Promise.all([B("admin/update-meta",{...r.value,name:c.value===""?void 0:c.value,maintainerName:k.value===""?void 0:k.value,maintainerEmail:z.value===""?void 0:z.value},U.token),B("admin/roles/update-default-policies",{policies:d.value},U.token)]).then(()=>{N("finished")}).catch(s=>{$({type:"error",title:s.code,text:s.message})}).finally(()=>{v()})}return(v,s)=>(p(),H("div",{class:"_gaps_m"},[o(w,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=u=>c.value=u),"data-cy-server-name":""},{label:i(()=>[a(t("ชื่อเซิร์ฟเวอร์"),1)]),_:1},8,["modelValue"]),o(y,{defaultOpen:!0},{label:i(()=>[a(t("ต้องการใช้ Misskey อย่างไร?"),1)]),icon:i(()=>[...s[7]||(s[7]=[e("i",{class:"ti ti-settings-question"},null,-1)])]),default:i(()=>[e("div",J,[o(T,{modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=u=>n.value=u),vertical:!0},{default:i(()=>[e("option",G,[e("div",null,[s[8]||(s[8]=e("i",{class:"ti ti-user"},null,-1)),s[9]||(s[9]=a()),e("b",null,t("เซิร์ฟเวอร์คนเดียว"),1)]),e("div",null,t("ใช้งานเป็นเซิร์ฟเวอร์ส่วนตัวสำหรับตัวเองคนเดียว"),1)]),e("option",K,[e("div",null,[s[10]||(s[10]=e("i",{class:"ti ti-lock"},null,-1)),s[11]||(s[11]=a()),e("b",null,t("เซิร์ฟเวอร์กลุ่ม"),1)]),e("div",null,t("เชิญผู้ใช้ที่เชื่อถือได้ มาเข้าร่วมใช้งานแบบหลายคน"),1)]),e("option",Q,[e("div",null,[s[12]||(s[12]=e("i",{class:"ti ti-world"},null,-1)),s[13]||(s[13]=a()),e("b",null,t("เซิร์ฟเวอร์สาธารณะ"),1)]),e("div",null,t("เปิดรับผู้ใช้จำนวนมากแบบไม่จำกัด"),1)])]),_:1},8,["modelValue"]),n.value==="single"?(p(),m(S,{key:0},{default:i(()=>[a(t("แม้จะใช้งานเป็นเซิร์ฟเวอร์ส่วนตัวสำหรับคนเดียว ก็สามารถสร้างบัญชีผู้ใช้หลายบัญชีได้ตามความจำเป็น"),1)]),_:1})):_("",!0),n.value==="open"?(p(),m(S,{key:1,warn:""},{default:i(()=>[e("b",null,t("คำแนะนำ")+":",1),a(" "+t("การเปิดรับผู้ใช้จำนวนมากมีความเสี่ยง ควรบริหารจัดการด้วยระบบดูแลที่เข้มงวดเพื่อรับมือกับปัญหาที่อาจเกิดขึ้น"),1)]),_:1})):_("",!0),n.value==="open"?(p(),m(S,{key:2,warn:""},{default:i(()=>[e("b",null,t("คำแนะนำ")+":",1),a(" "+t("เพื่อป้องกันไม่ให้เซิร์ฟเวอร์ของตนกลายเป็นแหล่งส่งสแปม ควรเปิดใช้งานฟีเจอร์ป้องกันบอต เช่น reCAPTCHA และใส่ใจเรื่องความปลอดภัยอย่างเคร่งครัด"),1)]),_:1})):_("",!0)])]),_:1}),n.value!=="single"?(p(),m(y,{key:0,defaultOpen:!0},{label:i(()=>[a(t("คาดว่าจะมีผู้ใช้งานประมาณกี่คน?"),1)]),icon:i(()=>[...s[14]||(s[14]=[e("i",{class:"ti ti-users"},null,-1)])]),default:i(()=>[e("div",X,[o(T,{modelValue:g.value,"onUpdate:modelValue":s[2]||(s[2]=u=>g.value=u),vertical:!0},{default:i(()=>[e("option",Z,[s[15]||(s[15]=e("i",{class:"ti ti-user"},null,-1)),a(" "+t("น้อยกว่า 100 คน (ขนาดเล็ก)"),1)]),e("option",h,[s[16]||(s[16]=e("i",{class:"ti ti-users"},null,-1)),a(" "+t("เกิน 100 คน แต่น้อยกว่า 1000 คน (ขนาดกลาง)"),1)]),e("option",ee,[s[17]||(s[17]=e("i",{class:"ti ti-users-group"},null,-1)),a(" "+t("เกิน 1000 คน (ขนาดใหญ่)"),1)])]),_:1},8,["modelValue"]),g.value==="large"?(p(),m(S,{key:0},{default:i(()=>[e("b",null,t("คำแนะนำ")+":",1),a(" "+t("เซิร์ฟเวอร์ขนาดใหญ่อาจต้องการความรู้ด้านโครงสร้างพื้นฐานขั้นสูง เช่น การบาลานซ์โหลด หรือการทำสำเนาฐานข้อมูล"),1)]),_:1})):_("",!0)])]),_:1})):_("",!0),o(y,{defaultOpen:!0},{label:i(()=>[a(t("เชื่อมต่อกับ Fediverse หรือไม่?"),1)]),icon:i(()=>[...s[18]||(s[18]=[e("i",{class:"ti ti-planet"},null,-1)])]),default:i(()=>[e("div",le,[e("div",null,[a(t("หากเชื่อมต่อกับเครือข่ายที่ประกอบด้วยเซิร์ฟเวอร์แบบกระจาย (Fediverse) จะสามารถแลกเปลี่ยนเนื้อหากับเซิร์ฟเวอร์อื่นๆ ได้"),1),s[19]||(s[19]=e("br",null,null,-1)),a(t("การเชื่อมต่อกับ Fediverse เรียกว่า “สหพันธ์”"),1),s[20]||(s[20]=e("br",null,null,-1)),o(D,{target:"_blank",url:"https://wikipedia.org/wiki/Fediverse"},{default:i(()=>[a(t("แสดงให้ดูหน่อย"),1)]),_:1})]),o(T,{modelValue:b.value,"onUpdate:modelValue":s[3]||(s[3]=u=>b.value=u),vertical:!0},{default:i(()=>[e("option",te,t("ใช่"),1),e("option",se,t("ไม่"),1)]),_:1},8,["modelValue"]),b.value==="yes"?(p(),m(S,{key:0},{default:i(()=>[a(t("หลังจากนี้ยังสามารถตั้งค่าแบบขั้นสูง เช่น การกำหนดเซิร์ฟเวอร์ที่อนุญาตให้สหพันธ์ต่อกันได้เพิ่มเติม"),1)]),_:1})):_("",!0),b.value==="yes"?(p(),m(E,{key:1,modelValue:C.value,"onUpdate:modelValue":s[4]||(s[4]=u=>C.value=u)},{label:i(()=>[a(t("การล้างข้อมูลเนื้อหาที่ได้รับโดยอัตโนมัติ"),1)]),caption:i(()=>[a(t("เมื่อมีการเชื่อมโยงสหพันธ์ จะได้รับเนื้อหาเป็นจำนวนมากอย่างต่อเนื่อง เมื่อเปิดใช้งานการล้างข้อมูลอัตโนมัติ จะทำการลบเนื้อหาเก่าที่ไม่ถูกอ้างอิง ไปจากเซิร์ฟเวอร์โดยอัตโนมัติ เพื่อประหยัดพื้นที่จัดเก็บข้อมูล"),1)]),_:1},8,["modelValue"])):_("",!0)])]),_:1}),n.value==="open"||b.value==="yes"?(p(),m(y,{key:1,defaultOpen:!0},{label:i(()=>[a(t("ข้อมูลผู้ดูแลระบ"),1)]),icon:i(()=>[...s[21]||(s[21]=[e("i",{class:"ti ti-mail"},null,-1)])]),default:i(()=>[e("div",ne,[e("div",null,t("ตั้งค่าข้อมูลผู้ดูแลระบบที่จะใช้รับคำถามและติดต่อ"),1),o(S,{warn:""},{default:i(()=>[a(t("หากเปิดใช้เซิร์ฟเวอร์สาธารณะ หรือเปิดใช้งานสหพันธ์ จะต้องกรอกข้อมูลนี้"),1)]),_:1}),o(w,{modelValue:k.value,"onUpdate:modelValue":s[5]||(s[5]=u=>k.value=u)},{label:i(()=>[a(t("ชื่อผู้ดูแลระบบ"),1)]),_:1},8,["modelValue"]),o(w,{modelValue:z.value,"onUpdate:modelValue":s[6]||(s[6]=u=>z.value=u),type:"email"},{label:i(()=>[a(t("อีเมลผู้ดูแลระบบ"),1)]),_:1},8,["modelValue"])])]),_:1})):_("",!0),o(y,{defaultOpen:!0,maxHeight:300},{label:i(()=>[a(t("แนะนำให้ตั้งค่าตามด้านล่างนี้"),1)]),icon:i(()=>[...s[22]||(s[22]=[e("i",{class:"ti ti-adjustments-alt"},null,-1)])]),footer:i(()=>[o(P,{gradate:"",large:"",rounded:"","data-cy-server-setup-wizard-apply":"",style:{margin:"0 auto"},onClick:O},{default:i(()=>[s[26]||(s[26]=e("i",{class:"ti ti-check"},null,-1)),a(" "+t("ใช้การตั้งค่านี้"),1)]),_:1})]),default:i(()=>[e("div",ie,[e("div",null,[e("div",null,[e("b",null,t("โหมดผู้ใช้คนเดียว")+":",1)]),e("div",null,t(r.value.singleUserMode?"ใช่":"ไม่"),1)]),e("div",null,[e("div",null,[e("b",null,t("เปิดให้สร้างบัญชีได้")+":",1)]),e("div",null,t(r.value.disableRegistration?"ไม่":"ใช่"),1)]),e("div",null,[e("div",null,[e("b",null,t("จำเป็นต้องการใช้ที่อยู่อีเมลสำหรับการสมัคร")+":",1)]),e("div",null,t(r.value.emailRequiredForSignup?"ใช่":"ไม่"),1)]),e("div",null,[s[23]||(s[23]=e("div",null,[e("b",null,"Log IP:")],-1)),e("div",null,t(r.value.enableIpLogging?"ใช่":"ไม่"),1)]),e("div",null,[e("div",null,[e("b",null,t("สหพันธ์")+":",1)]),e("div",null,t(r.value.federation==="none"?"ไม่":"ทั้งหมด"),1)]),e("div",null,[e("div",null,[e("b",null,t("การล้างข้อมูลโพสต์จากระยะไกลโดยอัตโนมัติ")+":",1)]),e("div",null,t(r.value.enableRemoteNotesCleaning?"ใช่":"ไม่"),1)]),e("div",null,[s[24]||(s[24]=e("div",null,[e("b",null,"FTT:")],-1)),e("div",null,t(r.value.enableFanoutTimeline?"ใช่":"ไม่"),1)]),e("div",null,[e("div",null,[e("b",null,"FTT/"+t("ฟอลแบ๊กกลับฐานข้อมูล")+":",1)]),e("div",null,t(r.value.enableFanoutTimelineDbFallback?"ใช่":"ไม่"),1)]),e("div",null,[s[25]||(s[25]=e("div",null,[e("b",null,"RBT:")],-1)),e("div",null,t(r.value.enableReactionsBuffering?"ใช่":"ไม่"),1)]),e("div",null,[e("div",null,[e("b",null,t("สไตล์ของหน้าเพจทางเข้า")+":",1)]),e("div",null,t(r.value.clientOptions?.entrancePageStyle),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("อัตราการจำกัด")+":",1)]),e("div",null,t(d.value.rateLimitFactor),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("ความจุของไดรฟ์")+":",1)]),e("div",null,t(d.value.driveCapacityMb)+" MB",1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("จำนวนรายชื่อผู้ใช้สูงสุด")+":",1)]),e("div",null,t(d.value.userListLimit),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("จำนวนสูงสุดของเสาอากาศ")+":",1)]),e("div",null,t(d.value.antennaLimit),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("จำนวนเว็บฮุคสูงสุด")+":",1)]),e("div",null,t(d.value.webhookLimit),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("อนุญาตให้นำเข้ารายการต่อไปนี้")+":",1)]),e("div",null,t(d.value.canImportFollowing?"ใช่":"ไม่"),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("อนุญาตให้นำเข้าการปิดเสียง")+":",1)]),e("div",null,t(d.value.canImportMuting?"ใช่":"ไม่"),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("อนุญาตให้นำเข้าการบล็อก")+":",1)]),e("div",null,t(d.value.canImportBlocking?"ใช่":"ไม่"),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("อนุญาตให้นำเข้ารายการ")+":",1)]),e("div",null,t(d.value.canImportUserLists?"ใช่":"ไม่"),1)]),e("div",null,[e("div",null,[e("b",null,t("แม่แบบบทบาท")+"/"+t("อนุญาตให้นำเข้าเสาอากาศ")+":",1)]),e("div",null,t(d.value.canImportAntennas?"ใช่":"ไม่"),1)])])]),_:1})],2))}});export{_e as M};
