import{R as D,c4 as x,cE as P,M as b,az as K,ah as z,d4 as B,J as N,cj as W,d5 as A,ck as L,W as M,cC as U}from"./3iSoGi4ic-DV-GuiCp.js";import{F as T}from"./3iSoGi4ic-D8X1N6Gw.js";import{M as k}from"./3iSoGi4ic-Fx-BY70c.js";import{b as S,c as E,l as m,i,p as o,C as g,B as a,x as j,E as s,h as t,D as l,F as $,A as O,a as y,z as H,f as w}from"./3iSoGi4ic-D0mTJ0Mu.js";import{F as J}from"./3iSoGi4ic-BBsRrkiB.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const q={key:0,class:"ti ti-plug"},G={key:1,class:"ti ti-palette"},Q={key:2,class:"ti ti-download"},X={key:2,class:"_gaps_s"},Y={class:"_gaps_s"},Z={key:3,class:"_gaps_s"},ee={class:"_gaps_s"},te={class:"_buttonsCenter"},se=S({__name:"MkExtensionInstaller",props:{extension:{}},emits:["confirm","cancel"],setup(u,{emit:c}){const d=E(()=>f.extension.type==="plugin"),p=E(()=>f.extension.type==="theme"),f=u,_=c;return(h,n)=>(i(),m("div",{class:"_gaps_m xmMP6"},[o("div",{class:"xEt3K"},[d.value?(i(),m("i",q)):p.value?(i(),m("i",G)):(i(),m("i",Q))],2),d.value?(i(),m("h2",{key:0,class:"xCDFy"},s("ต้องการติดตั้งปลั๊กอินนี้ใช่ไหม?"),3)):p.value?(i(),m("h2",{key:1,class:"xCDFy"},s("ต้องการติดตั้งธีมนี้ใช่ไหม?"),3)):g("",!0),a(D,{warn:!0},{default:t(()=>[l(s("โปรดตรวจสอบให้แน่ใจว่าแหล่งแจกหน่ายมีความน่าเชื่อถือก่อนทำการติดตั้ง"),1)]),_:1}),u.extension.type==="plugin"?(i(),m("div",X,[a(k,{defaultOpen:!0},{icon:t(()=>[...n[2]||(n[2]=[o("i",{class:"ti ti-info-circle"},null,-1)])]),label:t(()=>[l(s("Metadata"),1)]),default:t(()=>[o("div",Y,[a(T,null,{default:t(()=>[a(x,null,{key:t(()=>[l(s("ชื่อ"),1)]),value:t(()=>[l(s(u.extension.meta.name),1)]),_:1}),a(x,null,{key:t(()=>[l(s("ผู้เขียน"),1)]),value:t(()=>[l(s(u.extension.meta.author),1)]),_:1})]),_:1}),a(x,null,{key:t(()=>[l(s("คำอธิบาย"),1)]),value:t(()=>[l(s(u.extension.meta.description??"ไม่มี"),1)]),_:1}),a(x,null,{key:t(()=>[l(s("เวอร์ชั่น"),1)]),value:t(()=>[l(s(u.extension.meta.version),1)]),_:1}),a(x,null,{key:t(()=>[l(s("สิทธิ์"),1)]),value:t(()=>[u.extension.meta.permissions&&u.extension.meta.permissions.length>0?(i(),m("ul",{key:0,class:"xvmjR"},[(i(!0),m($,null,O(u.extension.meta.permissions,I=>(i(),m("li",{key:I},s({"read:account":"ดูข้อมูลบัญชี","write:account":"แก้ไขข้อมูลบัญชี","read:blocks":"ดูรายชื่อผู้ใช้ที่ถูกบล็อก","write:blocks":"แก้ไขรายชื่อผู้ใช้ที่ถูกบล็อก","read:drive":"เข้าถึงไดรฟ์","write:drive":"จัดการไดรฟ์","read:favorites":"ดูรายการโปรด","write:favorites":"แก้ไขรายการโปรด","read:following":"ดูข้อมูลว่าใครที่คุณติดตาม","write:following":"ติดตามหรือเลิกติดตามบัญชีอื่น","read:messaging":"ดูแชท","write:messaging":"เขียนหรือลบข้อความแชท","read:mutes":"ดูรายชื่อผู้ใช้ที่ถูกปิดเสียง","write:mutes":"แก้ไขรายชื่อผู้ใช้ที่ถูกปิดเสียง","write:notes":"เขียนหรือลบโน้ต","read:notifications":"ดูการแจ้งเตือน","write:notifications":"จัดการแจ้งเตือน","read:reactions":"ดูรีแอคชั่น","write:reactions":"แก้ไขรีแอคชั่น","write:votes":"โหวตบนสำรวจความคิดเห็น","read:pages":"ดูหน้าเพจ","write:pages":"แก้ไขหรือลบเพจ","read:page-likes":"ดูรายการเพจที่ถูกใจไว้","write:page-likes":"แก้ไขรายการเพจที่ถูกใจ","read:user-groups":"ดูกลุ่มผู้ใช้","write:user-groups":"แก้ไขหรือลบกลุ่มผู้ใช้","read:channels":"ดูช่อง","write:channels":"แก้ไขช่อง","read:gallery":"ดูแกลเลอรี่","write:gallery":"แก้ไขแกลเลอรี","read:gallery-likes":"ดูแกลเลอรีที่ถูกใจไว้","write:gallery-likes":"จัดการแกลเลอรีที่ถูกใจไว้","read:flash":"ดู Play","write:flash":"แก้ไข Play","read:flash-likes":"ดูรายการ  play ที่ถูกใจไว้","write:flash-likes":"แก้ไขรายการ play ที่ถูกใจไว้","read:admin:abuse-user-reports":"ดูรายงานจากผู้ใช้","write:admin:delete-account":"ลบบัญชีผู้ใช้","write:admin:delete-all-files-of-a-user":"ลบไฟล์ทั้งหมดของผู้ใช้","read:admin:index-stats":"ดูข้อมูลเกี่ยวกับดัชนีฐานข้อมูล","read:admin:table-stats":"ดูข้อมูลเกี่ยวกับตารางในฐานข้อมูล","read:admin:user-ips":"ดูที่อยู่ IP ของผู้ใช้","read:admin:meta":"ดูข้อมูลอภิพันธุ์ของอินสแตนซ์","write:admin:reset-password":"รีเซ็ตรหัสผ่านของผู้ใช้","write:admin:resolve-abuse-user-report":"แก้ไขรายงานจากผู้ใช้","write:admin:send-email":"ส่งอีเมล","read:admin:server-info":"ดูข้อมูลเซิร์ฟเวอร์","read:admin:show-moderation-log":"ดูปูมการควบคุมดูแล","read:admin:show-user":"ดูข้อมูลส่วนตัวของผู้ใช้","write:admin:suspend-user":"ระงับผู้ใช้","write:admin:unset-user-avatar":"ลบอวตารผู้ใช้","write:admin:unset-user-banner":"ลบแบนเนอร์ผู้ใช้","write:admin:unsuspend-user":"ยกเลิกการระงับผู้ใช้","write:admin:meta":"จัดการข้อมูลอภิพันธุ์ของอินสแตนซ์","write:admin:user-note":"จัดการโน้ตการกลั่นกรอง","write:admin:roles":"จัดการบทบาท","read:admin:roles":"ดูบทบาท","write:admin:relays":"จัดการรีเลย์","read:admin:relays":"ดูรีเลย์","write:admin:invite-codes":"จัดการรหัสเชิญ","read:admin:invite-codes":"ดูรหัสเชิญ","write:admin:announcements":"จัดการประกาศ","read:admin:announcements":"ดูประกาศ","write:admin:avatar-decorations":"จัดการการตกแต่งอวตาร","read:admin:avatar-decorations":"ดูการตกแต่งอวตาร","write:admin:federation":"จัดการข้อมูลเกี่ยวกับสหพันธ์","write:admin:account":"จัดการบัญชีผู้ใช้","read:admin:account":"ดูข้อมูลเกี่ยวกับผู้ใช้","write:admin:emoji":"จัดการเอโมจิ","read:admin:emoji":"ดูเอโมจิ","write:admin:queue":"จัดการคิวงาน","read:admin:queue":"ดูข้อมูลเกี่ยวกับคิวงาน","write:admin:promo":"จัดการโน้ตโปรโมชั่น","write:admin:drive":"จัดการไดรฟ์ของผู้ใช้","read:admin:drive":"ดูข้อมูลเกี่ยวกับไดรฟ์ของผู้ใช้","read:admin:stream":"ใช้ Websocket API สำหรับผู้ดูแลระบบ","write:admin:ad":"จัดการโฆษณา","read:admin:ad":"ดูโฆษณา","write:invite-codes":"สร้างรหัสเชิญ","read:invite-codes":"รับรหัสเชิญ","write:clip-favorite":"จัดการคลิปที่ถูกใจ","read:clip-favorite":"ดูคลิปที่ถูกใจ","read:federation":"รับข้อมูลเกี่ยวกับสหพันธ์","write:report-abuse":"รายงานการละเมิด","write:chat":"เขียนหรือลบข้อความแชท","read:chat":"อ่านแชต"}[I]),1))),128))],2)):(i(),m($,{key:1},[l(s("ไม่มี"),1)],64))]),_:1})])]),_:1}),a(k,{withSpacer:!1},{icon:t(()=>[...n[3]||(n[3]=[o("i",{class:"ti ti-code"},null,-1)])]),label:t(()=>[l(s("ดูต้นฉบับ"),1)]),default:t(()=>[a(P,{code:u.extension.raw},null,8,["code"])]),_:1})])):u.extension.type==="theme"?(i(),m("div",Z,[a(k,{defaultOpen:!0},{icon:t(()=>[...n[4]||(n[4]=[o("i",{class:"ti ti-info-circle"},null,-1)])]),label:t(()=>[l(s("Metadata"),1)]),default:t(()=>[o("div",ee,[a(T,null,{default:t(()=>[a(x,null,{key:t(()=>[l(s("ชื่อ"),1)]),value:t(()=>[l(s(u.extension.meta.name),1)]),_:1}),a(x,null,{key:t(()=>[l(s("ผู้เขียน"),1)]),value:t(()=>[l(s(u.extension.meta.author),1)]),_:1})]),_:1}),a(x,null,{key:t(()=>[l(s("โทนสีพื้นฐาน"),1)]),value:t(()=>[l(s({light:"สว่าง",dark:"มืด",none:"ไม่มี"}[u.extension.meta.base??"none"]),1)]),_:1})])]),_:1}),a(k,{withSpacer:!1},{icon:t(()=>[...n[5]||(n[5]=[o("i",{class:"ti ti-code"},null,-1)])]),label:t(()=>[l(s("โค้ดธีม"),1)]),default:t(()=>[a(P,{code:u.extension.raw},null,8,["code"])]),_:1})])):g("",!0),j(h.$slots,"additionalInfo"),o("div",te,[a(b,{danger:"",rounded:"",large:"",onClick:n[0]||(n[0]=I=>_("cancel"))},{default:t(()=>[n[6]||(n[6]=o("i",{class:"ti ti-x"},null,-1)),l(" "+s("ยกเลิก"),1)]),_:1}),a(b,{gradate:"",rounded:"",large:"",onClick:n[1]||(n[1]=I=>_("confirm"))},{default:t(()=>[n[7]||(n[7]=o("i",{class:"ti ti-download"},null,-1)),l(" "+s("ติดตั้ง"),1)]),_:1})])],2))}});const le={class:"_spacer",style:{"--MI_SPACER-w":"550px","--MI_SPACER-max":"50px"}},re={class:"_gaps_s"},ae={class:"_buttonsCenter"},he=S({__name:"install-extensions",setup(u){const c=y("fetching"),d=y({title:"",description:""}),p=y(null),f=y(null),_=y(null);function h(){window.history.length===1?window.close():window.history.back()}async function n(){if(!p.value||!f.value){d.value={title:"พารามิเตอร์ไม่ถูกต้อง",description:"มีสารสนเทศไม่เพียงพอที่จะโหลดข้อมูลจากไซต์ภายนอก โปรดยืนยัน URL ที่ป้อน"},c.value="error";return}const v=await N("fetch-external-resources",{url:p.value,hash:f.value}).catch(r=>{switch(r.id){case"bb774091-7a15-4a70-9dc5-6ac8cf125856":d.value={title:"รับข้อมูลล้มเหลว",description:"เกิดข้อผิดพลาดในการประมวลผลข้อมูลที่โหลดจากไซต์ภายนอก โปรดติดต่อผู้ดูแลเว็บไซต์"},c.value="error";break;case"693ba8ba-b486-40df-a174-72f8279b56a4":d.value={title:"การยืนยัน/ตรวจสอบข้อมูลล้มเหลว",description:"เกิดข้อผิดพลาดในการตรวจสอบความสมบูรณ์ของข้อมูลที่ดึงมา เพื่อเป็นมาตรการรักษาความปลอดภัย การติดตั้งไม่สามารถดำเนินการต่อได้ โปรดติดต่อผู้ดูแลเว็บไซต์"},c.value="error";break;default:d.value={title:"รับข้อมูลล้มเหลว",description:"เกิดข้อผิดพลาดในการสื่อสารกับไซต์ภายนอก หากการลองอีกครั้งไม่สามารถแก้ไขปัญหานี้ได้ โปรดติดต่อผู้ดูแลไซต์"},c.value="error";break}throw new Error(r.code)});if(!v){d.value={title:"รับข้อมูลล้มเหลว",description:"เกิดข้อผิดพลาดในการสื่อสารกับไซต์ภายนอก หากการลองอีกครั้งไม่สามารถแก้ไขปัญหานี้ได้ โปรดติดต่อผู้ดูแลไซต์"},c.value="error";return}switch(v.type){case"plugin":try{const r=await A(v.data);_.value={type:"plugin",meta:r,raw:v.data}}catch(r){d.value={title:"ข้อผิดพลาด AiScript",description:"ดึงข้อมูลที่ร้องขอสำเร็จแล้ว แต่มีข้อผิดพลาดเกิดขึ้นระหว่างการแยกวิเคราะห์ AiScript โปรดติดต่อผู้เขียนปลั๊กอิน รายละเอียดข้อผิดพลาดสามารถดูได้ในคอนโซล Javascript"},console.error(r),c.value="error";return}break;case"theme":try{const r=W(v.data),{id:C,props:R,desc:ne,...V}=r;_.value={type:"theme",meta:{...V},raw:v.data}}catch(r){if(!(r instanceof Error))throw r;switch(r.message.toLowerCase()){case"this theme is already installed":d.value={title:"การแยกวิเคราะห์ธีมล้มเหลว",description:"ธีมนี้ได้รับการติดตั้งแล้ว"};break;default:d.value={title:"การแยกวิเคราะห์ธีมล้มเหลว",description:"ดึงข้อมูลที่ร้องขอสำเร็จแล้ว แต่มีข้อผิดพลาดเกิดขึ้นระหว่างการแยกวิเคราะห์ธีม โปรดติดต่อผู้เขียนธีม รายละเอียดข้อผิดพลาดสามารถดูได้ในคอนโซล Javascript"};break}console.error(r),c.value="error";return}break;default:d.value={title:"ไม่รองรับทรัพยากรภายนอกนี้",description:"ไม่รองรับประเภทของทรัพยากรภายนอกนี้ โปรดติดต่อผู้ดูแลเว็บไซต์"},c.value="error";return}c.value="confirm"}async function I(){if(_.value)switch(_.value.type){case"plugin":if(!_.value.meta)return;try{await U(_.value.raw,_.value.meta),M(),window.setTimeout(()=>{h()},3e3)}catch(v){d.value={title:"ติดตั้งปลั๊กอินล้มเหลว",description:"เกิดปัญหาขณะติดตั้งปลั๊กอิน กรุณาลองอีกครั้ง. โปรดดูคอนโซล Javascript สำหรับรายละเอียดข้อผิดพลาด"},console.error(v),c.value="error"}break;case"theme":if(!_.value.meta)return;await L(_.value.raw),M(),window.setTimeout(()=>{h()},3e3)}}const F=new URLSearchParams(window.location.search);return p.value=F.get("url"),f.value=F.get("hash"),n(),K(()=>({title:"ติดตั้งจากไซต์ภายนอก",icon:"ti ti-download"})),(v,r)=>{const C=H("PageWithAnimBg");return i(),w(C,null,{default:t(()=>[o("div",le,[c.value==="fetching"?(i(),w(z,{key:0})):c.value==="confirm"&&_.value?(i(),w(se,{key:1,extension:_.value,onConfirm:r[0]||(r[0]=R=>I()),onCancel:r[1]||(r[1]=R=>h())},{additionalInfo:t(()=>[a(J,null,{default:t(()=>[o("div",re,[a(x,null,{key:t(()=>[l(s("จุดอ้างอิงปลายทาง (Referenced endpoint)"),1)]),value:t(()=>[p.value?(i(),w(B,{key:0,url:p.value,showUrlPreview:!1},null,8,["url"])):g("",!0)]),_:1}),a(x,null,{key:t(()=>[l(s("การตรวจสอบแฮช (ความสมบูรณ์ของไฟล์)"),1)]),value:t(()=>[...r[3]||(r[3]=[o("i",{class:"ti ti-check",style:{color:"var(--MI_THEME-accent)"}},null,-1)])]),_:1})])]),_:1})]),_:1},8,["extension"])):c.value==="error"?(i(),m("div",{key:2,class:"_gaps_m xbwuK xzwzK"},[o("div",{class:"xcgxV"},[...r[4]||(r[4]=[o("i",{class:"ti ti-circle-x"},null,-1)])],2),o("h2",{class:"xs2ew"},s(d.value?.title),3),o("div",{class:"xzl5u"},s(d.value?.description),3),o("div",ae,[a(b,{onClick:r[2]||(r[2]=R=>h())},{default:t(()=>[l(s("ปิด"),1)]),_:1})])],2)):g("",!0)])]),_:1})}}});export{he as default};
