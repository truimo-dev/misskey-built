import{f as t,g as S,F as l,S as u,j as d,h as o,i as R,v as g,k as A,l as $,E as T,m as c,n as f,o as h,q as I}from"./3iSoGi4ic-nJzNoieu.js";import{bg as O,a0 as E,J as k,bh as p,C as L,A as N,ai as U,$ as v,k as b}from"./3iSoGi4ic-DV-GuiCp.js";import{u as j,l as J}from"./3iSoGi4ic-B1GPmOGN.js";function w(s,e){t(s);const a=s.value;if(!e.includes(a)){const n=e.map(i=>`"${i}"`).join(", ");throw new S(`"${s.value}" is not in ${n}`)}}const M=["error","info","success","warning","waiting","question"];function q(s){return new Promise(e=>{b({title:s}).then(({result:a})=>{e(a??"")})})}function y(s){return{USER_ID:v?u(v.id):o,USER_NAME:v?.name?u(v.name):o,USER_USERNAME:v?u(v.username):o,CUSTOM_EMOJIS:d(U.value),LOCALE:u(J),SERVER_URL:u(j),"Mk:dialog":l(async([e,a,n])=>{let i,r,m="info";return e!=null&&(c(e)?i=e.value:f(e)),a!=null&&(c(a)?r=a.value:f(a)),n!=null&&(c(n)?(w(n,M),m=n.value):f(n)),await N({type:m,title:i,text:r}),o}),"Mk:confirm":l(async([e,a,n])=>{let i,r,m="question";return e!=null&&(c(e)?i=e.value:f(e)),a!=null&&(c(a)?r=a.value:f(a)),n!=null&&(c(n)?(w(n,M),m=n.value):f(n)),(await L({type:m,title:i,text:r})).canceled?h:I}),"Mk:toast":l(([e])=>(t(e),p(e.value),o)),"Mk:api":l(async([e,a,n])=>{if(t(e),e.value.includes("://")||e.value.includes(".."))throw new S("invalid endpoint");let i=null;if(n!=null&&!A(n)){if(t(n),typeof n.value!="string")throw new S("invalid token");i=n.value}if(i==null&&(i=s.token??null),a==null)throw new S("expected param");return $(a),k(e.value,g(a),i).then(r=>d(r),r=>T("request_failed",d(r)))}),"Mk:save":l(([e,a])=>(t(e),R(a),E.setItem(`aiscript:${s.storageKey}:${e.value}`,JSON.stringify(g(a))),o)),"Mk:load":l(([e])=>(t(e),d(E.getItemAsJson(`aiscript:${s.storageKey}:${e.value}`)??null))),"Mk:remove":l(([e])=>(t(e),E.removeItem(`aiscript:${s.storageKey}:${e.value}`),o)),"Mk:url":l(()=>u(window.location.href)),"Mk:nyaize":l(([e])=>(t(e),u(O(e.value))))}}const V=Object.freeze(Object.defineProperty({__proto__:null,aiScriptReadline:q,createAiScriptEnv:y},Symbol.toStringTag,{value:"Module"}));export{q as a,w as b,y as c,V as d};
