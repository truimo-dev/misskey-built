import{l as L,_ as U,bd as M,b7 as Q,aH as W}from"./3iSoGi4ic-DV-GuiCp.js";import{u as J}from"./3iSoGi4ic-DCTAa4Sx.js";import{b as I,a as l,e as E,H as F,l as x,i as v,p as e,t as i,s as z,D as B,E as m,c as N,g as K,B as T,o as O,f as X,h as Y,C as q}from"./3iSoGi4ic-D0mTJ0Mu.js";import{M as Z}from"./3iSoGi4ic-CC5SbM-1.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const te={class:"lcfyofjk"},oe=["viewBox"],ne=["id"],se=["id","width","height"],le=["points"],ae=["points"],ie=["cx","cy"],ue=["width","height"],ce={x:"1",y:"5"},ve=["viewBox"],re=["id"],de=["id","width","height"],pe=["points"],me=["points"],fe=["cx","cy"],_e=["width","height"],he={x:"1",y:"5"},xe=I({__name:"cpu-mem",props:{connection:{},meta:{}},setup(r){const n=r,s=l(50),o=l(30),t=l([]),c=L(),u=L(),d=L(),y=L(),p=l(""),k=l(""),_=l(""),P=l(""),f=l(),b=l(),C=l(),D=l(),g=l(""),h=l("");E(()=>{n.connection.on("stats",R),n.connection.on("statsLog",S),n.connection.send("requestLog",{id:L(),length:50})}),F(()=>{n.connection.off("stats",R),n.connection.off("statsLog",S)});function R($){t.value.push($),t.value.length>50&&t.value.shift();let a=t.value.map((w,G)=>[s.value-(t.value.length-1-G),(1-w.cpu)*o.value]),H=t.value.map((w,G)=>[s.value-(t.value.length-1-G),(1-w.mem.active/n.meta.mem.total)*o.value]);p.value=a.map(w=>`${w[0]},${w[1]}`).join(" "),k.value=H.map(w=>`${w[0]},${w[1]}`).join(" "),_.value=`${s.value-(t.value.length-1)},${o.value} ${p.value} ${s.value},${o.value}`,P.value=`${s.value-(t.value.length-1)},${o.value} ${k.value} ${s.value},${o.value}`,f.value=a.at(-1)[0],b.value=a.at(-1)[1],C.value=H.at(-1)[0],D.value=H.at(-1)[1],g.value=($.cpu*100).toFixed(0),h.value=($.mem.active/n.meta.mem.total*100).toFixed(0)}function S($){for(const a of $.toReversed())R(a)}return($,a)=>(v(),x("div",te,[(v(),x("svg",{viewBox:`0 0 ${s.value} ${o.value}`},[e("defs",null,[e("linearGradient",{id:i(c),x1:"0",x2:"0",y1:"1",y2:"0"},[...a[0]||(a[0]=[e("stop",{offset:"0%","stop-color":"hsl(180, 80%, 70%)"},null,-1),e("stop",{offset:"100%","stop-color":"hsl(0, 80%, 70%)"},null,-1)])],8,ne),e("mask",{id:i(u),x:"0",y:"0",width:s.value,height:o.value},[e("polygon",{points:_.value,fill:"#fff","fill-opacity":"0.5"},null,8,le),e("polyline",{points:p.value,fill:"none",stroke:"#fff","stroke-width":"1"},null,8,ae),e("circle",{cx:f.value,cy:b.value,r:"1.5",fill:"#fff"},null,8,ie)],8,se)]),e("rect",{x:"-2",y:"-2",width:s.value+4,height:o.value+4,style:z({stroke:"none",fill:`url(#${i(c)})`,mask:`url(#${i(u)})`})},null,12,ue),e("text",ce,[a[1]||(a[1]=B("CPU ",-1)),e("tspan",null,m(g.value)+"%",1)])],8,oe)),(v(),x("svg",{viewBox:`0 0 ${s.value} ${o.value}`},[e("defs",null,[e("linearGradient",{id:i(d),x1:"0",x2:"0",y1:"1",y2:"0"},[...a[2]||(a[2]=[e("stop",{offset:"0%","stop-color":"hsl(180, 80%, 70%)"},null,-1),e("stop",{offset:"100%","stop-color":"hsl(0, 80%, 70%)"},null,-1)])],8,re),e("mask",{id:i(y),x:"0",y:"0",width:s.value,height:o.value},[e("polygon",{points:P.value,fill:"#fff","fill-opacity":"0.5"},null,8,pe),e("polyline",{points:k.value,fill:"none",stroke:"#fff","stroke-width":"1"},null,8,me),e("circle",{cx:C.value,cy:D.value,r:"1.5",fill:"#fff"},null,8,fe)],8,de)]),e("rect",{x:"-2",y:"-2",width:s.value+4,height:o.value+4,style:z({stroke:"none",fill:`url(#${i(d)})`,mask:`url(#${i(y)})`})},null,12,_e),e("text",he,[a[3]||(a[3]=B("MEM ",-1)),e("tspan",null,m(h.value)+"%",1)])],8,ve))]))}}),ye=U(xe,[["__scopeId","data-v-da3f8b42"]]),$e={class:"oxxrhrto"},ge=["viewBox"],we=["points"],ke=["points"],Pe=["cx","cy"],Me={x:"1",y:"5"},Be=["viewBox"],be=["points"],Ce=["points"],He=["cx","cy"],Ie={x:"1",y:"5"},Se=I({__name:"net",props:{connection:{},meta:{}},setup(r){const n=r,s=l(50),o=l(30),t=l([]),c=l(""),u=l(""),d=l(""),y=l(""),p=l(),k=l(),_=l(),P=l(),f=l(0),b=l(0);E(()=>{n.connection.on("stats",C),n.connection.on("statsLog",D),n.connection.send("requestLog",{id:L(),length:50})}),F(()=>{n.connection.off("stats",C),n.connection.off("statsLog",D)});function C(g){t.value.push(g),t.value.length>50&&t.value.shift();const h=Math.max(1024*64,Math.max(...t.value.map(a=>a.net.rx))),R=Math.max(1024*64,Math.max(...t.value.map(a=>a.net.tx)));let S=t.value.map((a,H)=>[s.value-(t.value.length-1-H),(1-a.net.rx/h)*o.value]),$=t.value.map((a,H)=>[s.value-(t.value.length-1-H),(1-a.net.tx/R)*o.value]);c.value=S.map(a=>`${a[0]},${a[1]}`).join(" "),u.value=$.map(a=>`${a[0]},${a[1]}`).join(" "),d.value=`${s.value-(t.value.length-1)},${o.value} ${c.value} ${s.value},${o.value}`,y.value=`${s.value-(t.value.length-1)},${o.value} ${u.value} ${s.value},${o.value}`,p.value=S.at(-1)[0],k.value=S.at(-1)[1],_.value=$.at(-1)[0],P.value=$.at(-1)[1],f.value=g.net.rx,b.value=g.net.tx}function D(g){for(const h of g.toReversed())C(h)}return(g,h)=>(v(),x("div",$e,[(v(),x("svg",{viewBox:`0 0 ${s.value} ${o.value}`},[e("polygon",{points:d.value,fill:"#94a029","fill-opacity":"0.5"},null,8,we),e("polyline",{points:c.value,fill:"none",stroke:"#94a029","stroke-width":"1"},null,8,ke),e("circle",{cx:p.value,cy:k.value,r:"1.5",fill:"#94a029"},null,8,Pe),e("text",Me,[h[0]||(h[0]=B("NET rx ",-1)),e("tspan",null,m(i(M)(f.value)),1)])],8,ge)),(v(),x("svg",{viewBox:`0 0 ${s.value} ${o.value}`},[e("polygon",{points:y.value,fill:"#ff9156","fill-opacity":"0.5"},null,8,be),e("polyline",{points:u.value,fill:"none",stroke:"#ff9156","stroke-width":"1"},null,8,Ce),e("circle",{cx:_.value,cy:P.value,r:"1.5",fill:"#ff9156"},null,8,He),e("text",Ie,[h[1]||(h[1]=B("NET tx ",-1)),e("tspan",null,m(i(M)(b.value)),1)])],8,Be))]))}}),Xe=U(Se,[["__scopeId","data-v-4837c7da"]]),Le=["stroke-dasharray","stroke-dashoffset","stroke"],j=.45,V=I({__name:"pie",props:{value:{}},setup(r){const n=r,s=N(()=>`hsl(${180-n.value*180}, 80%, 70%)`),o=N(()=>(1-n.value)*(Math.PI*(j*2)));return(t,c)=>(v(),x("svg",{class:"xpClu",viewBox:"0 0 1 1",preserveAspectRatio:"none"},[e("circle",{r:j,cx:"50%",cy:"50%",fill:"none","stroke-width":"0.1",stroke:"rgba(0, 0, 0, 0.05)",class:"x4Qba"},null,2),e("circle",{r:j,cx:"50%",cy:"50%","stroke-dasharray":Math.PI*(j*2),"stroke-dashoffset":o.value,fill:"none","stroke-width":"0.1",class:"x4Qba",stroke:s.value},null,10,Le),e("text",{x:"50%",y:"50%",dy:"0.05","text-anchor":"middle",class:"xovP9"},m((r.value*100).toFixed(0))+"%",3)],2))}});const Ne={class:"vrvdvrys"},De=I({__name:"cpu",props:{connection:{},meta:{}},setup(r){const n=r,s=l(0);function o(t){s.value=t.cpu}return E(()=>{n.connection.on("stats",o)}),F(()=>{n.connection.off("stats",o)}),(t,c)=>(v(),x("div",Ne,[T(V,{class:"pie",value:s.value},null,8,["value"]),e("div",null,[c[0]||(c[0]=e("p",null,[e("i",{class:"ti ti-cpu"}),B("CPU")],-1)),e("p",null,m(r.meta.cpu.cores)+" Logical cores",1),e("p",null,m(r.meta.cpu.model),1)])]))}}),Re=U(De,[["__scopeId","data-v-466ef490"]]),Ue={class:"zlxnikvl"},Ye=I({__name:"mem",props:{connection:{},meta:{}},setup(r){const n=r,s=l(0),o=l(0),t=l(0),c=l(0);function u(d){s.value=d.mem.active/n.meta.mem.total,o.value=n.meta.mem.total,t.value=d.mem.active,c.value=o.value-t.value}return E(()=>{n.connection.on("stats",u)}),F(()=>{n.connection.off("stats",u)}),(d,y)=>(v(),x("div",Ue,[T(V,{class:"pie",value:s.value},null,8,["value"]),e("div",null,[y[0]||(y[0]=e("p",null,[e("i",{class:"ti ti-section"}),B("RAM")],-1)),e("p",null,"Total: "+m(i(M)(o.value,1)),1),e("p",null,"Used: "+m(i(M)(t.value,1)),1),e("p",null,"Free: "+m(i(M)(c.value,1)),1)])]))}}),je=U(Ye,[["__scopeId","data-v-1f285412"]]),Ee={class:"zbwaqsat"},Fe=I({__name:"disk",props:{meta:{}},setup(r){const n=r,s=N(()=>n.meta.fs.used/n.meta.fs.total),o=N(()=>n.meta.fs.total),t=N(()=>n.meta.fs.used),c=N(()=>n.meta.fs.total-n.meta.fs.used);return(u,d)=>(v(),x("div",Ee,[T(V,{class:"pie",value:s.value},null,8,["value"]),e("div",null,[d[0]||(d[0]=e("p",null,[e("i",{class:"ti ti-database"}),B("Disk")],-1)),e("p",null,"Total: "+m(i(M)(o.value,1)),1),e("p",null,"Free: "+m(i(M)(c.value,1)),1),e("p",null,"Used: "+m(i(M)(t.value,1)),1)])]))}}),Ge=U(Fe,[["__scopeId","data-v-6c7c39fb"]]),Te={key:0,"data-cy-mkw-serverMetric":"",class:"mkw-serverMetric"},A="serverMetric",Ke=I({__name:"index",props:{widget:{}},emits:["updateProps"],setup(r,{expose:n,emit:s}){const o={showHeader:{type:"boolean",default:!0},transparent:{type:"boolean",default:!1},view:{type:"number",default:0,hidden:!0}},t=r,c=s,{widgetProps:u,configure:d,save:y}=J(A,o,t,c),p=l(null);Q("server-info",{}).then(P=>{p.value=P});const k=()=>{u.view===4?u.view=0:u.view++,y()},_=W().useChannel("serverStats");return O(()=>{_.dispose()}),n({name:A,configure:d,id:t.widget?t.widget.id:null}),(P,f)=>(v(),X(Z,{showHeader:i(u).showHeader,naked:i(u).transparent},{icon:Y(()=>[...f[1]||(f[1]=[e("i",{class:"ti ti-server"},null,-1)])]),header:Y(()=>[B(m("ตัวชี้วัดเซิร์ฟเวอร์"),1)]),func:Y(({buttonStyleClass:b})=>[e("button",{class:K(["_button",b]),onClick:f[0]||(f[0]=C=>k())},[...f[2]||(f[2]=[e("i",{class:"ti ti-selector"},null,-1)])],2)]),default:Y(()=>[p.value?(v(),x("div",Te,[i(u).view===0?(v(),X(ye,{key:0,connection:i(_),meta:p.value},null,8,["connection","meta"])):i(u).view===1?(v(),X(Xe,{key:1,connection:i(_),meta:p.value},null,8,["connection","meta"])):i(u).view===2?(v(),X(Re,{key:2,connection:i(_),meta:p.value},null,8,["connection","meta"])):i(u).view===3?(v(),X(je,{key:3,connection:i(_),meta:p.value},null,8,["connection","meta"])):i(u).view===4?(v(),X(Ge,{key:4,meta:p.value},null,8,["meta"])):q("",!0)])):q("",!0)]),_:1},8,["showHeader","naked"]))}});export{Ke as default};
