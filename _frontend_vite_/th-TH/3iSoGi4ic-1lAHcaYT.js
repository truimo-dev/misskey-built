import{b as N,a as l,z as f,f as d,i as s,h as a,p as o,G as H,t as h,l as _,F as V,A as D,B as w,D as g,E as i}from"./3iSoGi4ic-D0mTJ0Mu.js";import{aF as G,b as L,J as U,b7 as W,ba as v,_ as q}from"./3iSoGi4ic-DV-GuiCp.js";import{u as E}from"./3iSoGi4ic-DCTAa4Sx.js";import{M as R}from"./3iSoGi4ic-CC5SbM-1.js";import{_ as T}from"./3iSoGi4ic-CS6W3O_2.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const z={class:"wbrkwalb"},J=["src"],S={class:"body"},k="federation",j=N({__name:"WidgetFederation",props:{widget:{}},emits:["updateProps"],setup(b,{expose:y,emit:M}){const x={showHeader:{type:"boolean",default:!0}},n=b,A=M,{widgetProps:I,configure:P}=E(k,x,n,A),m=l([]),u=l([]),p=l(!0);G(async()=>{const t=await U("federation/instances",{sort:"+latestRequestReceivedAt",limit:5}),r=await Promise.all(t.map(c=>W("charts/instance",{host:c.host,limit:16,span:"hour"})));m.value=t,u.value=r,p.value=!1},1e3*60,{immediate:!0,afterMounted:!0});function B(t){return v(t.iconUrl,"preview")??v(t.faviconUrl,"preview")??"/client-assets/dummy.png"}return y({name:k,configure:P,id:n.widget?n.widget.id:null}),(t,r)=>{const c=f("MkLoading"),C=f("MkA");return s(),d(R,{showHeader:h(I).showHeader,"data-cy-mkw-federation":"",class:"mkw-federation"},{icon:a(()=>[...r[0]||(r[0]=[o("i",{class:"ti ti-whirl"},null,-1)])]),header:a(()=>[g(i("สหพันธ์"),1)]),default:a(()=>[o("div",z,[p.value?(s(),d(c,{key:0})):(s(),d(H,{key:1,tag:"div",name:h(L).s.animation?"chart":"",class:"instances"},{default:a(()=>[(s(!0),_(V,null,D(m.value,(e,F)=>(s(),_("div",{key:e.id,class:"instance"},[o("img",{src:B(e),alt:""},null,8,J),o("div",S,[w(C,{class:"a",to:`/instance-info/${e.host}`,behavior:"window",title:e.host},{default:a(()=>[g(i(e.host),1)]),_:2},1032,["to","title"]),o("p",null,i(e.softwareName||"?")+" "+i(e.softwareVersion),1)]),w(T,{class:"chart",src:u.value[F].requests.received},null,8,["src"])]))),128))]),_:1},8,["name"]))])]),_:1},8,["showHeader"])}}}),ae=q(j,[["__scopeId","data-v-8bb7c713"]]);export{ae as default};
