const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-D6lvPj3q.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-DV-GuiCp.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-D0mTJ0Mu.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-B1GPmOGN.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-Dty8GuTz.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/scripts/3iSoGi4ic-D98_HDRS.js","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/assets/3iSoGi4ic-DZU1WGtr.css","https://fastly.jsdelivr.net/gh/truimo-dev/misskey-built@latest/_frontend_vite_/assets/3iSoGi4ic-9GwroBN9.css"])))=>i.map(i=>d[i]);
import{i as R,aQ as _,aR as D,aS as N,ag as $,M as b,e as T,l as H,w as O,r as G}from"./3iSoGi4ic-DV-GuiCp.js";import{b as L,c as m,l as g,i as l,F as S,p as s,B as r,t as p,R as X,h as u,D as f,E as x,d as F,q as v,f as z,U as V,A as h}from"./3iSoGi4ic-D0mTJ0Mu.js";const q=["onClick"],K=["onClick"],Q={class:"handle"},te=L({__name:"MkWidgets",props:{widgets:{},edit:{type:Boolean}},emits:["updateWidgets","addWidget","removeWidget","updateWidget","exit"],setup(C,{emit:U}){const M=F(()=>T(()=>import("./3iSoGi4ic-D6lvPj3q.js").then(t=>t.v),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url).then(t=>t.default)),w=C,y=m(()=>R.federation==="none"?_.filter(t=>!D.includes(t)):_),P=m(()=>w.widgets.filter(t=>y.value.includes(t.name))),d=U,c={},W=t=>{c[t].configure()},{model:a,def:A}=N({items:m(()=>[{label:"无",value:null},...y.value.map(t=>({label:{"profile":"个人资料","instanceInfo":"服务器信息","memo":"便签","notifications":"通知","timeline":"时间线","calendar":"日历","trends":"趋势","clock":"时钟","rss":"RSS 阅读器","rssTicker":"RSS Ticker","activity":"活动","photos":"照片","digitalClock":"数字时钟","unixClock":"UNIX 时钟","federation":"联合","instanceCloud":"服务器云","postForm":"投稿窗口","slideshow":"幻灯片展示","button":"按钮","onlineUsers":"在线用户","jobQueue":"作业队列","serverMetric":"服务器指标","aiscript":"AiScript 控制台","aiscriptApp":"AiScript App","aichan":"小蓝","userList":"用户列表","_userList":{"chooseList":"选择列表"},"clicker":"点击器","birthdayFollowings":"今天是他们的生日","chat":"私信"}[t],value:t}))]),initialValue:null}),B=()=>{a.value!=null&&(d("addWidget",{name:a.value,id:H(),data:{}}),a.value=null)},E=t=>{d("removeWidget",t)},k=(t,i)=>{d("updateWidget",{id:t,data:i})};function I(t,i){const e=i.target;e&&O(e)||e&&(["INPUT","TEXTAREA","IMG","VIDEO","CANVAS"].includes(e.tagName)||e.attributes.contenteditable)||window.getSelection()?.toString()===""&&G([{type:"label",text:{"profile":"个人资料","instanceInfo":"服务器信息","memo":"便签","notifications":"通知","timeline":"时间线","calendar":"日历","trends":"趋势","clock":"时钟","rss":"RSS 阅读器","rssTicker":"RSS Ticker","activity":"活动","photos":"照片","digitalClock":"数字时钟","unixClock":"UNIX 时钟","federation":"联合","instanceCloud":"服务器云","postForm":"投稿窗口","slideshow":"幻灯片展示","button":"按钮","onlineUsers":"在线用户","jobQueue":"作业队列","serverMetric":"服务器指标","aiscript":"AiScript 控制台","aiscriptApp":"AiScript App","aichan":"小蓝","userList":"用户列表","_userList":{"chooseList":"选择列表"},"clicker":"点击器","birthdayFollowings":"今天是他们的生日","chat":"私信"}[t.name]},{icon:"ti ti-settings",text:"设置",action:()=>{W(t.id)}}],i)}return(t,i)=>(l(),g("div",{class:"xu9Pu"},[C.edit?(l(),g(S,{key:0},[s("header",{class:"x3G7w"},[r($,{modelValue:p(a),"onUpdate:modelValue":i[0]||(i[0]=e=>X(a)?a.value=e:null),items:p(A),style:{"margin-bottom":"var(--MI-margin)"},"data-cy-widget-select":""},{label:u(()=>[f(x("选择小工具"),1)]),_:1},8,["modelValue","items"]),r(b,{inline:"",primary:"","data-cy-widget-add":"",onClick:B},{default:u(()=>[i[3]||(i[3]=s("i",{class:"ti ti-plus"},null,-1)),f(" "+x("添加"),1)]),_:1}),r(b,{inline:"",onClick:i[1]||(i[1]=e=>d("exit"))},{default:u(()=>[f(x("关闭"),1)]),_:1})],2),r(p(M),{modelValue:w.widgets,itemKey:"id",handle:".handle",animation:150,group:{name:"SortableMkWidgets"},class:"xxy4P","onUpdate:modelValue":i[2]||(i[2]=e=>d("updateWidgets",e))},{item:u(({element:e})=>[s("div",{class:"xtI5S x45uz","data-cy-customize-container":""},[s("button",{class:"xglxg _button",onClick:v(n=>W(e.id),["prevent","stop"])},[...i[4]||(i[4]=[s("i",{class:"ti ti-settings"},null,-1)])],10,q),s("button",{class:"xBUui _button","data-cy-customize-container-remove":"",onClick:v(n=>E(e),["prevent","stop"])},[...i[5]||(i[5]=[s("i",{class:"ti ti-x"},null,-1)])],10,K),s("div",Q,[(l(),z(V(`widget-${e.name}`),{ref:n=>c[e.id]=n,class:"widget xnO1U",widget:e,onUpdateProps:n=>k(e.id,n)},null,40,["class","widget","onUpdateProps"]))])],2)]),_:1},8,["modelValue","class"])],64)):(l(!0),g(S,{key:1},h(P.value,e=>(l(),z(V(`widget-${e.name}`),{key:e.id,ref_for:!0,ref:n=>c[e.id]=n,class:"xtI5S",widget:e,onUpdateProps:n=>k(e.id,n),onContextmenu:v(n=>I(e,n),["stop"])},null,40,["class","widget","onUpdateProps","onContextmenu"]))),128))],2))}});export{te as X};
