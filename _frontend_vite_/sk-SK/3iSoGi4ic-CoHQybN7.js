import{M as T}from"./3iSoGi4ic-CdSqfJMx.js";import{P as E,az as P,$ as m,R as I,M as V,C as $,J as R,a6 as B}from"./3iSoGi4ic-DV-GuiCp.js";import{b as H,m as z,c as k,a as U,z as f,f as h,i as e,h as l,p as a,C as n,B as r,t as p,D as _,E as d,l as i,F as N,A as Y}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-Dv7rS4og.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";const D={class:"_spacer",style:{"--MI_SPACER-w":"800px"}},F={class:"_gaps"},Q={key:0,style:{"margin-right":"0.5em"}},S={style:{"margin-right":"0.5em"}},W={key:0,class:"ti ti-info-circle"},q={key:1,class:"ti ti-alert-triangle",style:{color:"var(--MI_THEME-warn)"}},J={key:2,class:"ti ti-circle-x",style:{color:"var(--MI_THEME-error)"}},L={key:3,class:"ti ti-check",style:{color:"var(--MI_THEME-success)"}},j=["src"],G={style:{"margin-top":"8px",opacity:"0.7","font-size":"85%"}},K={key:0,style:{opacity:"0.7","font-size":"85%"}},ct=H({__name:"announcements",setup(O){const x=z(new E("announcements",{limit:10,computedParams:k(()=>({isActive:u.value==="current"}))})),u=U("current");async function A(c){c.needConfirmationToRead&&(await $({type:"question",title:"Mark as read?",text:(({title})=>("This will mark the contents of \""+title+"\" as read."))({title:c.title})})).canceled||(x.updateItem(c.id,s=>({...s,isRead:!0})),R("i/read-announcement",{announcementId:c.id}),B({unreadAnnouncements:m.unreadAnnouncements.filter(s=>s.id!==c.id)}))}const M=k(()=>[]),C=k(()=>[{key:"current",title:"Current announcements",icon:"ti ti-flare"},{key:"past",title:"Past announcements",icon:"ti ti-point"}]);return P(()=>({title:"Oznamy",icon:"ti ti-speakerphone"})),(c,s)=>{const v=f("MkA"),w=f("Mfm"),g=f("MkTime"),b=f("PageWithHeader");return e(),h(b,{tab:u.value,"onUpdate:tab":s[0]||(s[0]=y=>u.value=y),actions:M.value,tabs:C.value,swipable:!0},{default:l(()=>[a("div",D,[a("div",F,[p(m)&&p(m).hasUnreadAnnouncement&&u.value==="current"?(e(),h(I,{key:0,warn:""},{default:l(()=>[_(d("There are unread announcements."),1)]),_:1})):n("",!0),r(T,{paginator:p(x),class:"_gaps"},{default:l(({items:y})=>[(e(!0),i(N,null,Y(y,t=>(e(),i("section",{key:t.id,class:"_panel xdVm7"},[t.forYou?(e(),i("div",{key:0,class:"x293V"},[s[1]||(s[1]=a("i",{class:"ti ti-pin"},null,-1)),_(" "+d("For you"),1)],2)):n("",!0),a("div",{class:"xps0w"},[p(m)&&!t.silence&&!t.isRead?(e(),i("span",Q,"ðŸ†•")):n("",!0),a("span",S,[t.icon==="info"?(e(),i("i",W)):t.icon==="warning"?(e(),i("i",q)):t.icon==="error"?(e(),i("i",J)):t.icon==="success"?(e(),i("i",L)):n("",!0)]),r(v,{to:`/announcements/${t.id}`},{default:l(()=>[a("span",null,d(t.title),1)]),_:2},1032,["to"])],2),a("div",{class:"xnwQ0"},[r(w,{text:t.text,class:"_selectable"},null,8,["text"]),t.imageUrl?(e(),i("img",{key:0,src:t.imageUrl},null,8,j)):n("",!0),r(v,{to:`/announcements/${t.id}`},{default:l(()=>[a("div",G,[_(d("VytvorenÃ©")+": ",1),r(g,{time:t.createdAt,mode:"detail"},null,8,["time"])]),t.updatedAt?(e(),i("div",K,[_(d("UpravenÃ©")+": ",1),r(g,{time:t.updatedAt,mode:"detail"},null,8,["time"])])):n("",!0)]),_:2},1032,["to"])],2),u.value!=="past"&&p(m)&&!t.silence&&!t.isRead?(e(),i("div",{key:1,class:"xnxso"},[r(V,{primary:"",onClick:X=>A(t)},{default:l(()=>[s[2]||(s[2]=a("i",{class:"ti ti-check"},null,-1)),_(" "+d("Rozumiem!"),1)]),_:1},8,["onClick"])],2)):n("",!0)],2))),128))]),_:1},8,["paginator"])])])]),_:1},8,["tab","actions","tabs"])}}});export{ct as default};
