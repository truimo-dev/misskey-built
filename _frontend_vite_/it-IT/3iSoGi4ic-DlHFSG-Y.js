import{a7 as w,R as S,bl as D,ab as E,M as P,bm as Y,J as B,A as $}from"./3iSoGi4ic-DV-GuiCp.js";import{M as y}from"./3iSoGi4ic-Fx-BY70c.js";import{_ as T}from"./3iSoGi4ic-Dz5OvLqt.js";import{b as j,a as f,c as q,l as H,i as p,B as o,f as m,C as _,h as i,D as a,E as t,p as e}from"./3iSoGi4ic-D0mTJ0Mu.js";const J={class:"_gaps_s"},G={value:"single"},K={value:"group"},Q={value:"open"},X={class:"_gaps_s"},Z={value:"small"},h={value:"medium"},ee={value:"large"},le={class:"_gaps_s"},te={value:"yes"},se={value:"no"},ne={class:"_gaps_s"},ie={class:"_gaps_s"},_e=j({__name:"MkServerSetupWizard",props:{token:{}},emits:["finished"],setup(x,{emit:A}){const N=A,U=x,c=f(""),n=f("single"),g=f("small"),b=f("yes"),C=f(!0),k=f(""),z=f(""),r=q(()=>{let v;return n.value==="single"?v=!1:v=g.value!=="small",{singleUserMode:n.value==="single",disableRegistration:n.value!=="open",emailRequiredForSignup:n.value==="open",enableIpLogging:n.value==="open",federation:b.value==="yes"?"all":"none",enableRemoteNotesCleaning:C.value,enableFanoutTimeline:!0,enableFanoutTimelineDbFallback:n.value==="single",enableReactionsBuffering:v,clientOptions:{entrancePageStyle:n.value==="open"?"classic":"simple"}}}),d=q(()=>{let v;n.value==="single"?v=8192:n.value==="group"?v=1e3:n.value==="open"&&(v=100);let s;n.value==="single"?s=.3:n.value==="group"?s=.7:n.value==="open"&&(g.value==="small"?s=1:g.value==="medium"?s=1.25:g.value==="large"&&(s=1.5));let u;n.value==="single"?u=100:n.value==="group"?u=5:n.value==="open"&&(u=3);let M;n.value==="single"?M=100:n.value==="group"?M=5:n.value==="open"&&(M=0);let W;n.value==="single"?W=100:(n.value==="group"||n.value==="open")&&(W=0);let F;n.value==="single"?F=!0:F=!1;let V;n.value==="single"?V=!0:V=!1;let I;n.value==="single"?I=!0:I=!1;let R;n.value==="single"?R=!0:R=!1;let L;return n.value==="single"?L=!0:L=!1,{rateLimitFactor:s,driveCapacityMb:v,userListLimit:u,antennaLimit:M,webhookLimit:W,canImportFollowing:F,canImportMuting:V,canImportBlocking:I,canImportUserLists:R,canImportAntennas:L}});function O(){const v=Y();Promise.all([B("admin/update-meta",{...r.value,name:c.value===""?void 0:c.value,maintainerName:k.value===""?void 0:k.value,maintainerEmail:z.value===""?void 0:z.value},U.token),B("admin/roles/update-default-policies",{policies:d.value},U.token)]).then(()=>{N("finished")}).catch(s=>{$({type:"error",title:s.code,text:s.message})}).finally(()=>{v()})}return(v,s)=>(p(),H("div",{class:"_gaps_m"},[o(w,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=u=>c.value=u),"data-cy-server-name":""},{label:i(()=>[a(t("Nome dell'istanza"),1)]),_:1},8,["modelValue"]),o(y,{defaultOpen:!0},{label:i(()=>[a(t("Come si usa Misskey?"),1)]),icon:i(()=>[...s[7]||(s[7]=[e("i",{class:"ti ti-settings-question"},null,-1)])]),default:i(()=>[e("div",J,[o(T,{modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=u=>n.value=u),vertical:!0},{default:i(()=>[e("option",G,[e("div",null,[s[8]||(s[8]=e("i",{class:"ti ti-user"},null,-1)),s[9]||(s[9]=a()),e("b",null,t("Modalità utenza singola"),1)]),e("div",null,t("Se intendi usarlo come tuo server personale"),1)]),e("option",K,[e("div",null,[s[10]||(s[10]=e("i",{class:"ti ti-lock"},null,-1)),s[11]||(s[11]=a()),e("b",null,t("Modalità multi utentza"),1)]),e("div",null,t("Invita altre persone fidate ad usare il server insieme a te"),1)]),e("option",Q,[e("div",null,[s[12]||(s[12]=e("i",{class:"ti ti-world"},null,-1)),s[13]||(s[13]=a()),e("b",null,t("Server aperto"),1)]),e("div",null,t("Per ospitare un numero imprecisato di persone"),1)])]),_:1},8,["modelValue"]),n.value==="single"?(p(),m(S,{key:0},{default:i(()=>[a(t("Anche se lo utilizzi come server per una sola persona, puoi creare più account in base alle tue esigenze."),1)]),_:1})):_("",!0),n.value==="open"?(p(),m(S,{key:1,warn:""},{default:i(()=>[e("b",null,t("Consiglio")+":",1),a(" "+t("Ospitare un numero imprecisato di persone comporta dei rischi. Ti consigliamo di adottare un solido sistema di moderazione, in modo da poter gestire eventuali problemi che potrebbero presentarsi pubblicando contenuti proposti da altre persone, che potrebbero essere sconosciute."),1)]),_:1})):_("",!0),n.value==="open"?(p(),m(S,{key:2,warn:""},{default:i(()=>[e("b",null,t("Consiglio")+":",1),a(" "+t("Presta molta attenzione alla sicurezza, ad esempio attivando funzionalità anti-bot (iscrizioni automatiche) come reCAPTCHA. Questo può evitare che il tuo server diventi un trampolino di lancio per lo spam di altri."),1)]),_:1})):_("",!0)])]),_:1}),n.value!=="single"?(p(),m(y,{key:0,defaultOpen:!0},{label:i(()=>[a(t("Quante persone pensi che parteciperanno?"),1)]),icon:i(()=>[...s[14]||(s[14]=[e("i",{class:"ti ti-users"},null,-1)])]),default:i(()=>[e("div",X,[o(T,{modelValue:g.value,"onUpdate:modelValue":s[2]||(s[2]=u=>g.value=u),vertical:!0},{default:i(()=>[e("option",Z,[s[15]||(s[15]=e("i",{class:"ti ti-user"},null,-1)),a(" "+t("100 persone o meno (piccolo)"),1)]),e("option",h,[s[16]||(s[16]=e("i",{class:"ti ti-users"},null,-1)),a(" "+t("Da 100 a 1000 persone (medio)"),1)]),e("option",ee,[s[17]||(s[17]=e("i",{class:"ti ti-users-group"},null,-1)),a(" "+t("Oltre 1000 persone (grande)"),1)])]),_:1},8,["modelValue"]),g.value==="large"?(p(),m(S,{key:0},{default:i(()=>[e("b",null,t("Consiglio")+":",1),a(" "+t("Configurare grandi server potrebbe richiedere conoscenze infrastrutturali avanzate, ad esempio, il bilanciamento del carico e la replicazione del database."),1)]),_:1})):_("",!0)])]),_:1})):_("",!0),o(y,{defaultOpen:!0},{label:i(()=>[a(t("Vuoi connetterti al Fediverso?"),1)]),icon:i(()=>[...s[18]||(s[18]=[e("i",{class:"ti ti-planet"},null,-1)])]),default:i(()=>[e("div",le,[e("div",null,[a(t("Collegandosi a una rete di server distribuiti, denominata Fediverso, potrai scambiare contenuti con altri server, tramite il protocollo di comunicazione ActivityPub."),1),s[19]||(s[19]=e("br",null,null,-1)),a(t("Connettersi al Fediverso è anche detto \"federazione\"."),1),s[20]||(s[20]=e("br",null,null,-1)),o(D,{target:"_blank",url:"https://wikipedia.org/wiki/Fediverse"},{default:i(()=>[a(t("Per saperne di più"),1)]),_:1})]),o(T,{modelValue:b.value,"onUpdate:modelValue":s[3]||(s[3]=u=>b.value=u),vertical:!0},{default:i(()=>[e("option",te,t("Sì"),1),e("option",se,t("No"),1)]),_:1},8,["modelValue"]),b.value==="yes"?(p(),m(S,{key:0},{default:i(()=>[a(t("Puoi svolgere la configurazione avanzata anche dopo. Ad esempio specificando quali server possono federarsi."),1)]),_:1})):_("",!0),b.value==="yes"?(p(),m(E,{key:1,modelValue:C.value,"onUpdate:modelValue":s[4]||(s[4]=u=>C.value=u)},{label:i(()=>[a(t("Pulizia automatica dei contenuti in arrivo"),1)]),caption:i(()=>[a(t("Con la federazione funzionante, riceverai sempre più contenuti. Abilitando la pulizia automatica, i contenuti non referenziati e obsoleti verranno rimossi automaticamente dai tuoi server, risparmiando spazio di archiviazione."),1)]),_:1},8,["modelValue"])):_("",!0)])]),_:1}),n.value==="open"||b.value==="yes"?(p(),m(y,{key:1,defaultOpen:!0},{label:i(()=>[a(t("Informazioni sull'amministratore"),1)]),icon:i(()=>[...s[21]||(s[21]=[e("i",{class:"ti ti-mail"},null,-1)])]),default:i(()=>[e("div",ne,[e("div",null,t("Imposta le informazioni dell'amministratore utilizzate per accettare le richieste."),1),o(S,{warn:""},{default:i(()=>[a(t("Questa operazione è necessaria su un server aperto o se è attiva la federazione."),1)]),_:1}),o(w,{modelValue:k.value,"onUpdate:modelValue":s[5]||(s[5]=u=>k.value=u)},{label:i(()=>[a(t("Nome dell'amministratore"),1)]),_:1},8,["modelValue"]),o(w,{modelValue:z.value,"onUpdate:modelValue":s[6]||(s[6]=u=>z.value=u),type:"email"},{label:i(()=>[a(t("Indirizzo e-mail dell'amministratore"),1)]),_:1},8,["modelValue"])])]),_:1})):_("",!0),o(y,{defaultOpen:!0,maxHeight:300},{label:i(()=>[a(t("Si consigliano le seguenti impostazioni:"),1)]),icon:i(()=>[...s[22]||(s[22]=[e("i",{class:"ti ti-adjustments-alt"},null,-1)])]),footer:i(()=>[o(P,{gradate:"",large:"",rounded:"","data-cy-server-setup-wizard-apply":"",style:{margin:"0 auto"},onClick:O},{default:i(()=>[s[26]||(s[26]=e("i",{class:"ti ti-check"},null,-1)),a(" "+t("Applica questa impostazione"),1)]),_:1})]),default:i(()=>[e("div",ie,[e("div",null,[e("div",null,[e("b",null,t("Modalità utente singolo")+":",1)]),e("div",null,t(r.value.singleUserMode?"Sì":"No"),1)]),e("div",null,[e("div",null,[e("b",null,t("Registrazioni aperte")+":",1)]),e("div",null,t(r.value.disableRegistration?"No":"Sì"),1)]),e("div",null,[e("div",null,[e("b",null,t("L'indirizzo e-mail è obbligatorio per registrarsi")+":",1)]),e("div",null,t(r.value.emailRequiredForSignup?"Sì":"No"),1)]),e("div",null,[s[23]||(s[23]=e("div",null,[e("b",null,"Log IP:")],-1)),e("div",null,t(r.value.enableIpLogging?"Sì":"No"),1)]),e("div",null,[e("div",null,[e("b",null,t("Federazione")+":",1)]),e("div",null,t(r.value.federation==="none"?"No":"Tutte"),1)]),e("div",null,[e("div",null,[e("b",null,t("Pulizia automatica dei contenuti remoti")+":",1)]),e("div",null,t(r.value.enableRemoteNotesCleaning?"Sì":"No"),1)]),e("div",null,[s[24]||(s[24]=e("div",null,[e("b",null,"FTT:")],-1)),e("div",null,t(r.value.enableFanoutTimeline?"Sì":"No"),1)]),e("div",null,[e("div",null,[e("b",null,"FTT/"+t("Elaborazione dati alternativa")+":",1)]),e("div",null,t(r.value.enableFanoutTimelineDbFallback?"Sì":"No"),1)]),e("div",null,[s[25]||(s[25]=e("div",null,[e("b",null,"RBT:")],-1)),e("div",null,t(r.value.enableReactionsBuffering?"Sì":"No"),1)]),e("div",null,[e("div",null,[e("b",null,t("Stile della pagina di ingresso")+":",1)]),e("div",null,t(r.value.clientOptions?.entrancePageStyle),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Limite del rapporto")+":",1)]),e("div",null,t(d.value.rateLimitFactor),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Capienza del Drive")+":",1)]),e("div",null,t(d.value.driveCapacityMb)+" MB",1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Quantità massima di liste")+":",1)]),e("div",null,t(d.value.userListLimit),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Quantità massima di Antenne")+":",1)]),e("div",null,t(d.value.antennaLimit),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Quantità massima di Webhook")+":",1)]),e("div",null,t(d.value.webhookLimit),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Può importare Following")+":",1)]),e("div",null,t(d.value.canImportFollowing?"Sì":"No"),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Può importare Silenziati")+":",1)]),e("div",null,t(d.value.canImportMuting?"Sì":"No"),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Può importare Blocchi")+":",1)]),e("div",null,t(d.value.canImportBlocking?"Sì":"No"),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Può importare liste di Profili")+":",1)]),e("div",null,t(d.value.canImportUserLists?"Sì":"No"),1)]),e("div",null,[e("div",null,[e("b",null,t("Ruolo di base")+"/"+t("Può importare Antenne")+":",1)]),e("div",null,t(d.value.canImportAntennas?"Sì":"No"),1)])])]),_:1})],2))}});export{_e as M};
