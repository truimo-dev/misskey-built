import{aF as P}from"./3iSoGi4ic-DV-GuiCp.js";import{u as B}from"./3iSoGi4ic-B1GPmOGN.js";import{u as L}from"./3iSoGi4ic-DCTAa4Sx.js";import{M as D}from"./3iSoGi4ic-CC5SbM-1.js";import{b as F,a as p,c as v,w as b,z as y,f,i as r,h as n,p as o,l as w,t as l,g as T,F as W,A as j,E as z,D as N}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-D98_HDRS.js";const V={class:"ekmkgxbj"},$=["href","title"],x="rss",X=F({__name:"WidgetRss",props:{widget:{}},emits:["updateProps"],setup(M,{expose:_,emit:C}){const E={url:{type:"string",default:"http://feeds.afpbb.com/rss/afpbb/afpbbnews"},refreshIntervalSec:{type:"number",default:60},maxEntries:{type:"number",default:15},showHeader:{type:"boolean",default:!0}},i=M,S=C,{widgetProps:s,configure:u}=L(x,E,i,S),d=p([]),c=v(()=>d.value.slice(0,s.maxEntries)),g=p(!0),h=v(()=>{const t=new URL("/api/fetch-rss",B);return t.searchParams.set("url",s.url),t}),m=p(),k=()=>{window.document.visibilityState==="hidden"&&d.value.length!==0||window.fetch(h.value,{}).then(t=>t.json()).then(t=>{d.value=t.items,g.value=!1})};return b(()=>h,k),b(()=>s.refreshIntervalSec,()=>{m.value&&m.value(),m.value=P(k,Math.max(1e4,s.refreshIntervalSec*1e3),{immediate:!0,afterMounted:!0})},{immediate:!0}),_({name:x,configure:u,id:i.widget?i.widget.id:null}),(t,e)=>{const R=y("MkLoading"),H=y("MkResult");return r(),f(D,{showHeader:l(s).showHeader,"data-cy-mkw-rss":"",class:"mkw-rss"},{icon:n(()=>[...e[1]||(e[1]=[o("i",{class:"ti ti-rss"},null,-1)])]),header:n(()=>[...e[2]||(e[2]=[N("RSS",-1)])]),func:n(({buttonStyleClass:a})=>[o("button",{class:T(["_button",a]),onClick:e[0]||(e[0]=(...I)=>l(u)&&l(u)(...I))},[...e[3]||(e[3]=[o("i",{class:"ti ti-settings"},null,-1)])],2)]),default:n(()=>[o("div",V,[g.value?(r(),f(R,{key:0})):(!c.value||c.value.length===0)&&l(s).showHeader?(r(),f(H,{key:1,type:"empty"})):(r(),w("div",{key:2,class:"xeEfl"},[(r(!0),w(W,null,j(c.value,a=>(r(),w("a",{key:a.link,class:"x5Tps",href:a.link,rel:"nofollow noopener",target:"_blank",title:a.title},z(a.title),11,$))),128))],2))])]),_:1},8,["showHeader"])}}});export{X as default};
