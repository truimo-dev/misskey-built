import{J as B,M as F,af as q,a7 as w,ab as D,ag as E,ad as O}from"./3iSoGi4ic-DV-GuiCp.js";import{M as R}from"./3iSoGi4ic-BDF7xMl0.js";import{M as $}from"./3iSoGi4ic-CSc4cSLM.js";import{_ as P}from"./3iSoGi4ic-Dz5OvLqt.js";import{i18n as _}from"./3iSoGi4ic-Dty8GuTz.js";import{b as I,a as A,c as T,l as r,i as n,B as j,p,h as s,D as V,E as a,g as z,u as J,r as Y,z as K,f as u,F as g,A as S,C,a2 as b}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-CZYXc2mx.js";const L=I({__name:"MkFormDialog.file",props:{fileId:{},validate:{type:Function}},emits:["update"],setup(x,{emit:M}){const c=x,k=M,f=A(""),t=A(""),U=T(()=>t.value?t.value:f.value?f.value:_.ts.fileNotSelected);c.fileId&&B("drive/files/show",{fileId:c.fileId}).then(y=>{t.value=y.name,f.value=y.url});function h(y){q({anchorElement:y.currentTarget??y.target,multiple:!1}).then(async m=>{m&&(c.validate&&!await c.validate(m)||(k("update",m),t.value=m.name,f.value=m.url))})}return(y,m)=>(n(),r("div",null,[j(F,{inline:"",rounded:"",primary:"",onClick:m[0]||(m[0]=d=>h(d))},{default:s(()=>[V(a(_.ts.selectFile),1)]),_:1}),p("div",{class:z(["_nowrap",!t.value&&"x7Y7u"])},a(U.value),3)]))}});const W={class:"_spacer",style:{"--MI_SPACER-min":"20px","--MI_SPACER-max":"32px"}},X={key:0,class:"_gaps_m"},G=["textContent"],H={key:0},Q=["textContent"],Z={key:0},v=["textContent"],ee={key:0},te=["textContent"],ne=["textContent"],le={key:0},oe=["textContent"],ae={key:0},se=["value"],ie=["textContent"],de={key:0},re=["textContent"],be=I({__name:"MkFormDialog",props:{title:{},form:{}},emits:["done","closed"],setup(x,{emit:M}){const c=x,k=M,f=J("dialog"),t=Y({});for(const d in c.form)"default"in c.form[d]?t[d]=c.form[d].default??null:t[d]=null;function U(){k("done",{result:t}),f.value?.close()}function h(){k("done",{canceled:!0}),f.value?.close()}function y(d){return d.enum.map(i=>typeof i=="string"?{value:i,label:i}:{value:i.value,label:i.label})}function m(d){return typeof d.value=="string"?d.value:JSON.stringify(d.value)}return(d,i)=>{const N=K("MkResult");return n(),u(O,{ref_key:"dialog",ref:f,width:450,canClose:!1,withOkButton:!0,okButtonDisabled:!1,onClick:i[0]||(i[0]=e=>h()),onOk:i[1]||(i[1]=e=>U()),onClose:i[2]||(i[2]=e=>h()),onClosed:i[3]||(i[3]=e=>k("closed"))},{header:s(()=>[V(a(x.title),1)]),default:s(()=>[p("div",W,[Object.keys(x.form).filter(e=>!x.form[e].hidden).length>0?(n(),r("div",X,[(n(!0),r(g,null,S(Object.fromEntries(Object.entries(x.form)),(e,l)=>(n(),r(g,null,[(typeof e.hidden=="function"?e.hidden(t):e.hidden)?(n(),r(g,{key:0},[],64)):e.type==="number"?(n(),u(w,{key:1,modelValue:t[l],"onUpdate:modelValue":o=>t[l]=o,type:"number",step:e.step||1},b({label:s(()=>[p("span",{textContent:a(e.label||l)},null,8,G),e.required===!1?(n(),r("span",H," ("+a(_.ts.optional)+")",1)):C("",!0)]),_:2},[e.description?{name:"caption",fn:s(()=>[V(a(e.description),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","step"])):e.type==="string"&&!e.multiline?(n(),u(w,{key:2,modelValue:t[l],"onUpdate:modelValue":o=>t[l]=o,type:"text",mfmAutocomplete:e.treatAsMfm},b({label:s(()=>[p("span",{textContent:a(e.label||l)},null,8,Q),e.required===!1?(n(),r("span",Z," ("+a(_.ts.optional)+")",1)):C("",!0)]),_:2},[e.description?{name:"caption",fn:s(()=>[V(a(e.description),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","mfmAutocomplete"])):e.type==="string"&&e.multiline?(n(),u(R,{key:3,modelValue:t[l],"onUpdate:modelValue":o=>t[l]=o,mfmAutocomplete:e.treatAsMfm,mfmPreview:e.treatAsMfm},b({label:s(()=>[p("span",{textContent:a(e.label||l)},null,8,v),e.required===!1?(n(),r("span",ee," ("+a(_.ts.optional)+")",1)):C("",!0)]),_:2},[e.description?{name:"caption",fn:s(()=>[V(a(e.description),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","mfmAutocomplete","mfmPreview"])):e.type==="boolean"?(n(),u(D,{key:4,modelValue:t[l],"onUpdate:modelValue":o=>t[l]=o},b({default:s(()=>[p("span",{textContent:a(e.label||l)},null,8,te)]),_:2},[e.description?{name:"caption",fn:s(()=>[V(a(e.description),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"])):e.type==="enum"?(n(),u(E,{key:5,modelValue:t[l],"onUpdate:modelValue":o=>t[l]=o,items:y(e)},{label:s(()=>[p("span",{textContent:a(e.label||l)},null,8,ne),e.required===!1?(n(),r("span",le," ("+a(_.ts.optional)+")",1)):C("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])):e.type==="radio"?(n(),u(P,{key:6,modelValue:t[l],"onUpdate:modelValue":o=>t[l]=o},{label:s(()=>[p("span",{textContent:a(e.label||l)},null,8,oe),e.required===!1?(n(),r("span",ae," ("+a(_.ts.optional)+")",1)):C("",!0)]),default:s(()=>[(n(!0),r(g,null,S(e.options,o=>(n(),r("option",{key:m(o),value:o.value},a(o.label),9,se))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type==="range"?(n(),u($,{key:7,modelValue:t[l],"onUpdate:modelValue":o=>t[l]=o,min:e.min,max:e.max,step:e.step,textConverter:e.textConverter},b({label:s(()=>[p("span",{textContent:a(e.label||l)},null,8,ie),e.required===!1?(n(),r("span",de," ("+a(_.ts.optional)+")",1)):C("",!0)]),_:2},[e.description?{name:"caption",fn:s(()=>[V(a(e.description),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","min","max","step","textConverter"])):e.type==="button"?(n(),u(F,{key:8,onClick:o=>e.action(o,t)},{default:s(()=>[p("span",{textContent:a(e.content||l)},null,8,re)]),_:2},1032,["onClick"])):e.type==="drive-file"?(n(),u(L,{key:9,fileId:e.defaultFileId,validate:async o=>!e.validate||await e.validate(o),onUpdate:o=>t[l]=o},null,8,["fileId","validate","onUpdate"])):C("",!0)],64))),256))])):(n(),u(N,{key:1,type:"empty"}))])]),_:1},512)}}});export{be as default};
