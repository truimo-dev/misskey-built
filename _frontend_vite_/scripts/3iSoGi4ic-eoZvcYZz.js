import{b as I,a as i,c as g,w,z as R,f as x,i as r,h as n,p as o,g as P,l as u,B as y,T as H,t as l,F as L,A as X,E as q,D as A}from"./3iSoGi4ic-D0mTJ0Mu.js";import{aF as D}from"./3iSoGi4ic-DV-GuiCp.js";import{u as F}from"./3iSoGi4ic-DCTAa4Sx.js";import{M as N}from"./3iSoGi4ic-CXH-8M55.js";import{M as V}from"./3iSoGi4ic-CC5SbM-1.js";import{s as W}from"./3iSoGi4ic-BgiUUhZ3.js";import{u as $}from"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-Dty8GuTz.js";import"./3iSoGi4ic-D98_HDRS.js";const j={key:1},U=["href","title"],b="rssTicker",ae=I({__name:"WidgetRssTicker",props:{widget:{}},emits:["updateProps"],setup(M,{expose:_,emit:z}){const B={url:{type:"string",default:"http://feeds.afpbb.com/rss/afpbb/afpbbnews"},shuffle:{type:"boolean",default:!0},refreshIntervalSec:{type:"number",default:60},maxEntries:{type:"number",default:15},duration:{type:"range",default:70,step:1,min:5,max:200},reverse:{type:"boolean",default:!1},showHeader:{type:"boolean",default:!1},transparent:{type:"boolean",default:!1}},d=M,C=z,{widgetProps:t,configure:f}=F(b,B,d,C),c=i([]),E=g(()=>{const e=c.value.slice(0,t.maxEntries);return t.shuffle&&W(e),e}),m=i(!0),v=g(()=>{const e=new URL("/api/fetch-rss",$);return e.searchParams.set("url",t.url),e}),p=i(),k=i(0),h=()=>{window.document.visibilityState==="hidden"&&c.value.length!==0||window.fetch(v.value,{}).then(e=>e.json()).then(e=>{c.value=e.items,m.value=!1,k.value++})};return w(()=>v,h),w(()=>t.refreshIntervalSec,()=>{p.value&&p.value(),p.value=D(h,Math.max(1e4,t.refreshIntervalSec*1e3),{immediate:!0,afterMounted:!0})},{immediate:!0}),_({name:b,configure:f,id:d.widget?d.widget.id:null}),(e,s)=>{const S=R("MkEllipsis");return r(),x(V,{naked:l(t).transparent,showHeader:l(t).showHeader,class:"mkw-rss-ticker"},{icon:n(()=>[...s[1]||(s[1]=[o("i",{class:"ti ti-rss"},null,-1)])]),header:n(()=>[...s[2]||(s[2]=[A("RSS",-1)])]),func:n(({buttonStyleClass:a})=>[o("button",{class:P(["_button",a]),onClick:s[0]||(s[0]=(...T)=>l(f)&&l(f)(...T))},[...s[3]||(s[3]=[o("i",{class:"ti ti-settings"},null,-1)])],2)]),default:n(()=>[o("div",{class:"xqXRz"},[m.value?(r(),u("div",{key:0,class:"xcA1y"},[y(S)],2)):(r(),u("div",j,[y(H,{name:"xsfLM",mode:"default",appear:""},{default:n(()=>[(r(),x(N,{key:k.value,duration:l(t).duration,reverse:l(t).reverse},{default:n(()=>[(r(!0),u(L,null,X(E.value,a=>(r(),u("span",{key:a.link,class:"xzB1l"},[o("a",{href:a.link,rel:"nofollow noopener",target:"_blank",title:a.title},q(a.title),9,U),o("span",{class:"xtXzk"},null,2)],2))),128))]),_:1},8,["duration","reverse"]))]),_:1},8,["name"])]))],2)]),_:1},8,["naked","showHeader"])}}});export{ae as default};
