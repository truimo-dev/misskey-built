import{I as h}from"./3iSoGi4ic-nJzNoieu.js";import{P as k}from"./3iSoGi4ic-KYydmxIu.js";import{u as _}from"./3iSoGi4ic-DCTAa4Sx.js";import{$ as M,A as C}from"./3iSoGi4ic-DV-GuiCp.js";import{c as P,a as S}from"./3iSoGi4ic-CCt4ZT5M.js";import{M as E,r as B}from"./3iSoGi4ic-BgYi9BfU.js";import{M as H}from"./3iSoGi4ic-CC5SbM-1.js";import{b as I,a as i,w as b,e as N,f as l,i as p,h as u,p as V,l as W,C as $,D as z,t as D}from"./3iSoGi4ic-D0mTJ0Mu.js";import"./3iSoGi4ic-C0O4p9AH.js";import"./3iSoGi4ic-Ddz4upM5.js";import"./3iSoGi4ic-ke9ZaMpT.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-Dty8GuTz.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-BDF7xMl0.js";import"./3iSoGi4ic-Fx-BY70c.js";import"./3iSoGi4ic-DUrJvqB4.js";const U={key:0},d="aiscriptApp",ie=I({__name:"WidgetAiscriptApp",props:{widget:{}},emits:["updateProps"],setup(f,{expose:g,emit:w}){const y={script:{type:"string",multiline:!0,default:""},showHeader:{type:"boolean",default:!0}},r=f,v=w,{widgetProps:o,configure:x}=_(d,y,r,v),A=new k,s=i(),n=i([]),a=i(!1);async function c(){a.value=!1;const m=new h({...P({storageKey:"widget",token:M?.token}),...B(n.value,e=>{s.value=e.value})},{in:S,out:e=>{},log:(e,K)=>{}});let t;try{t=A.parse(o.script)}catch{a.value=!0;return}try{await m.exec(t)}catch(e){C({type:"error",title:"AiScript Error",text:e instanceof Error?e.message:String(e)})}}return b(()=>o.script,()=>{c()}),N(()=>{c()}),g({name:d,configure:x,id:r.widget?r.widget.id:null}),(m,t)=>(p(),l(H,{showHeader:D(o).showHeader,class:"mkw-aiscriptApp"},{header:u(()=>[...t[0]||(t[0]=[z("App",-1)])]),default:u(()=>[V("div",{class:"xsIcm"},[a.value?(p(),W("div",U,"Syntax error :(")):s.value?(p(),l(E,{key:1,component:s.value,components:n.value,size:"small"},null,8,["component","components"])):$("",!0)],2)]),_:1},8,["showHeader"]))}});export{ie as default};
