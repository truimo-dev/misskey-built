import{J as P,U as V}from"./3iSoGi4ic-DV-GuiCp.js";import{b as D,u as k,a as $,e as N,z as B,l as L,i as y,f as S,C as T,j as Y,v as I,p as u,B as d,h as m,D as E}from"./3iSoGi4ic-D0mTJ0Mu.js";import{i as U,u as j,C as H,c as J,a as O}from"./3iSoGi4ic-CqmhgU-Q.js";import{M as W,c as X}from"./3iSoGi4ic-C7_f0Ypu.js";import{M as R}from"./3iSoGi4ic-DtDbNQ4_.js";import{_ as z}from"./3iSoGi4ic-atZAPWr2.js";import"./3iSoGi4ic-B1GPmOGN.js";import"./3iSoGi4ic-Dty8GuTz.js";import"./3iSoGi4ic-D98_HDRS.js";import"./3iSoGi4ic-BPp9MNgd.js";const A=30,K=D({__name:"activity.pv",props:{user:{}},setup(p){U();const v=p,e=k("chartEl"),g=k("legendEl"),l=new Date;let i=null;const c=$(!0),{handler:h}=j();async function b(){if(e.value==null)return;i&&i.destroy();const f=s=>{const a=l.getFullYear(),r=l.getMonth(),F=l.getDate();return new Date(a,r,F-s)},o=s=>s.map((a,r)=>({x:f(r).getTime(),y:a})),t=await P("charts/user/pv",{userId:v.user.id,limit:A,span:"day"}),x=V.s.darkMode?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",w="#3498db",_="#2ecc71",C="#3498db88",M="#2ecc7188";function n(s,a,r={}){return Object.assign({label:s,data:a,parsing:!1,pointRadius:0,borderWidth:0,borderJoinStyle:"round",borderRadius:4,barPercentage:.7,categoryPercentage:.7,fill:!0},r)}i=new H(e.value,{type:"bar",data:{datasets:[n("UPV (user)",o(t.upv.user).slice().reverse(),{backgroundColor:w,stack:"u"}),n("UPV (visitor)",o(t.upv.visitor).slice().reverse(),{backgroundColor:_,stack:"u"}),n("NPV (user)",o(t.pv.user).slice().reverse(),{backgroundColor:C,stack:"n"}),n("NPV (visitor)",o(t.pv.visitor).slice().reverse(),{backgroundColor:M,stack:"n"})]},options:{aspectRatio:3,layout:{padding:{left:0,right:8,top:0,bottom:0}},scales:{x:{type:"time",offset:!0,stacked:!0,time:{unit:"day",displayFormats:{day:"M/d",month:"Y/M"}},grid:{display:!1},ticks:{display:!0,maxRotation:0,autoSkipPadding:8}},y:{position:"left",stacked:!0,suggestedMax:10,grid:{display:!0},ticks:{display:!0}}},interaction:{intersect:!1,mode:"index"},plugins:{title:{display:!0,text:"Unique/Natural PV",padding:{top:0,bottom:12}},legend:{display:!1},tooltip:{enabled:!1,mode:"index",animation:{duration:0},external:h},gradient:O}},plugins:[J(x),X(g.value)]}),c.value=!1}return N(async()=>{b()}),(f,o)=>{const t=B("MkLoading");return y(),L("div",null,[c.value?(y(),S(t,{key:0})):T("",!0),Y(u("div",{class:"xE4Q6 _panel"},[u("canvas",{ref_key:"chartEl",ref:e},null,512),d(W,{ref_key:"legendEl",ref:g,style:{"margin-top":"8px"}},null,512)],2),[[I,!c.value]])])}}});const Q=50,q=D({__name:"activity.notes",props:{user:{}},setup(p){U();const v=p,e=k("chartEl"),g=k("legendEl"),l=new Date;let i=null;const c=$(!0),{handler:h}=j();async function b(){if(e.value==null)return;i&&i.destroy();const f=s=>{const a=l.getFullYear(),r=l.getMonth(),F=l.getDate();return new Date(a,r,F-s)},o=s=>s.map((a,r)=>({x:f(r).getTime(),y:a})),t=await P("charts/user/notes",{userId:v.user.id,limit:Q,span:"day"}),x=V.s.darkMode?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",w="#008FFB",_="#FEB019",C="#00E396",M="#e300db";function n(s,a,r={}){return Object.assign({label:s,data:a,parsing:!1,pointRadius:0,borderWidth:0,borderJoinStyle:"round",borderRadius:4,barPercentage:.9,fill:!0},r)}i=new H(e.value,{type:"bar",data:{datasets:[n("File",o(t.diffs.withFile).slice().reverse(),{backgroundColor:M}),n("Renote",o(t.diffs.renote).slice().reverse(),{backgroundColor:C}),n("Reply",o(t.diffs.reply).slice().reverse(),{backgroundColor:_}),n("Normal",o(t.diffs.normal).slice().reverse(),{backgroundColor:w})]},options:{aspectRatio:3,layout:{padding:{left:0,right:8,top:0,bottom:0}},scales:{x:{type:"time",offset:!0,stacked:!0,time:{unit:"day",displayFormats:{day:"M/d",month:"Y/M"}},grid:{display:!1},ticks:{display:!0,maxRotation:0,autoSkipPadding:8}},y:{position:"left",stacked:!0,suggestedMax:10,grid:{display:!0},ticks:{display:!0}}},interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!1},tooltip:{enabled:!1,mode:"index",animation:{duration:0},external:h},gradient:O}},plugins:[J(x),X(g.value)]}),c.value=!1}return N(async()=>{b()}),(f,o)=>{const t=B("MkLoading");return y(),L("div",null,[c.value?(y(),S(t,{key:0})):T("",!0),Y(u("div",{class:"xhKY1 _panel"},[u("canvas",{ref_key:"chartEl",ref:e},null,512),d(W,{ref_key:"legendEl",ref:g,style:{"margin-top":"8px"}},null,512)],2),[[I,!c.value]])])}}});const G=30,Z=D({__name:"activity.following",props:{user:{}},setup(p){U();const v=p,e=k("chartEl"),g=k("legendEl"),l=new Date;let i=null;const c=$(!0),{handler:h}=j();async function b(){if(e.value==null)return;i&&i.destroy();const f=s=>{const a=l.getFullYear(),r=l.getMonth(),F=l.getDate();return new Date(a,r,F-s)},o=s=>s.map((a,r)=>({x:f(r).getTime(),y:a})),t=await P("charts/user/following",{userId:v.user.id,limit:G,span:"day"}),x=V.s.darkMode?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",w="#008FFB",_="#008FFB88",C="#2ecc71",M="#2ecc7188";function n(s,a,r={}){return Object.assign({label:s,data:a,parsing:!1,pointRadius:0,borderWidth:0,borderJoinStyle:"round",borderRadius:4,barPercentage:.7,categoryPercentage:.7,fill:!0},r)}i=new H(e.value,{type:"bar",data:{datasets:[n("Follow (local)",o(t.local.followings.inc).slice().reverse(),{backgroundColor:w,stack:"follow"}),n("Follow (remote)",o(t.remote.followings.inc).slice().reverse(),{backgroundColor:_,stack:"follow"}),n("Followed (local)",o(t.local.followers.inc).slice().reverse(),{backgroundColor:C,stack:"followed"}),n("Followed (remote)",o(t.remote.followers.inc).slice().reverse(),{backgroundColor:M,stack:"followed"})]},options:{aspectRatio:3,layout:{padding:{left:0,right:8,top:0,bottom:0}},scales:{x:{type:"time",offset:!0,stacked:!0,time:{unit:"day",displayFormats:{day:"M/d",month:"Y/M"}},grid:{display:!1},ticks:{display:!0,maxRotation:0,autoSkipPadding:8}},y:{position:"left",stacked:!0,suggestedMax:10,grid:{display:!0},ticks:{display:!0}}},interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!1},tooltip:{enabled:!1,mode:"index",animation:{duration:0},external:h},gradient:O}},plugins:[J(x),X(g.value)]}),c.value=!1}return N(async()=>{b()}),(f,o)=>{const t=B("MkLoading");return y(),L("div",null,[c.value?(y(),S(t,{key:0})):T("",!0),Y(u("div",{class:"xDt5p _panel"},[u("canvas",{ref_key:"chartEl",ref:e},null,512),d(W,{ref_key:"legendEl",ref:g,style:{"margin-top":"8px"}},null,512)],2),[[I,!c.value]])])}}});const ee={class:"_spacer",style:{"--MI_SPACER-w":"700px"}},te={class:"_gaps"},fe=D({__name:"activity",props:{user:{}},setup(p){return(v,e)=>(y(),L("div",ee,[u("div",te,[d(R,{class:"item"},{header:m(()=>[...e[0]||(e[0]=[u("i",{class:"ti ti-activity"},null,-1),E(" Heatmap",-1)])]),default:m(()=>[d(z,{user:p.user,src:"notes"},null,8,["user"])]),_:1}),d(R,{class:"item"},{header:m(()=>[...e[1]||(e[1]=[u("i",{class:"ti ti-pencil"},null,-1),E(" Notes",-1)])]),default:m(()=>[d(q,{user:p.user},null,8,["user"])]),_:1}),d(R,{class:"item"},{header:m(()=>[...e[2]||(e[2]=[u("i",{class:"ti ti-users"},null,-1),E(" Following",-1)])]),default:m(()=>[d(Z,{user:p.user},null,8,["user"])]),_:1}),d(R,{class:"item"},{header:m(()=>[...e[3]||(e[3]=[u("i",{class:"ti ti-eye"},null,-1),E(" PV",-1)])]),default:m(()=>[d(K,{user:p.user},null,8,["user"])]),_:1})])]))}});export{fe as default};
